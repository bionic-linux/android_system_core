{
  "comments": [
    {
      "key": {
        "uuid": "8f9b903a_ff6ee3de",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 417,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-16T15:01:49Z",
      "side": 1,
      "message": "For your use case, are all entries in fstab_recs on the sdcard? (no fstab-entry is on the main flash)",
      "range": {
        "startLine": 417,
        "startChar": 34,
        "endLine": 417,
        "endChar": 51
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3153e85_1f77e18c",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T05:07:19Z",
      "side": 1,
      "message": "Note that mount point isn\u0027t necessarily partition_name.\n\ne.g.,\nit\u0027s possible to mount /dev/block/platform/soc.0/f9824900.sdhci/by-name/vendor under /vendor_test or something else",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "df0fdf61_2960ef46",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T05:50:11Z",
      "side": 1,
      "message": "Yes. If we do not mount at detail name like /vendor, this logic will fail. It so I think we need add a map for partition and detail device node.",
      "parentUuid": "b3153e85_1f77e18c",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "646b3858_e526a2a0",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T08:47:33Z",
      "side": 1,
      "message": "uevent.partition_name should be basename(fstab_rec-\u003eblk_device)",
      "parentUuid": "df0fdf61_2960ef46",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e3bb23cc_d9007d53",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T09:02:54Z",
      "side": 1,
      "message": "uevent.partition_name is like vendor_a\\vendor_b. Seem we also should not used as base name.",
      "parentUuid": "646b3858_e526a2a0",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2402c0e1_403568c2",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T09:11:20Z",
      "side": 1,
      "message": "fstab_rec-\u003eblk_device will be \"/dev/block/platform/soc.0/f1234567.sdhci/by-name/vendor_a\" if you have \u0027slotselect\u0027 in the fstab entry.",
      "parentUuid": "e3bb23cc_d9007d53",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf312068_05632d71",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 423,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T09:18:36Z",
      "side": 1,
      "message": "Yes. We enable slotselect.\nwe can compare vendor_a in blk_device with the uevent partition name.",
      "parentUuid": "2402c0e1_403568c2",
      "range": {
        "startLine": 423,
        "startChar": 21,
        "endLine": 423,
        "endChar": 69
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d6d76f61_7e9ffb4f",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-16T15:01:49Z",
      "side": 1,
      "message": "This might be an issue if there are different blk_path in a fstab file.\n\ne.g., in the fstab:\n/dev/block/platform/soc.0/f9824900.sdhci/by-name/vendor\n\n/dev/block/platform/soc.0/f1234567.sdhci/by-name/system\n\nIf you get uevent of \".../f9824900.sdhci/by-name/system\", valid_uevent is true. This might end up exit the early mount uevent process and cannot find \"f1234567.sdhci/by-name/system\" .",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9be47054_d18df9c0",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T01:57:57Z",
      "side": 1,
      "message": "Bowgo,\nThis logic can work both below scenes.\nall partition are in the same flash ;\nsome partition in sdcard, other partition are in emmc.\ne.g:\nfstab:\n/dev/block/platform/soc.0/f9824900.sdhci/by-name/vendor\n/dev/block/platform/soc.0/f1234567.sdhci/by-name/system\n\nget uevent of \".../f9824900.sdhci/by-name/system\", it will compare both \"f9824900.sdhci\" and \"system\", so valid_uevent will be false. Only partition name and the block device in uevent both meet the fstab,this uevent can be a valid event.",
      "parentUuid": "d6d76f61_7e9ffb4f",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ac58c5e3_0f0e95de",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T05:07:19Z",
      "side": 1,
      "message": "Ah, sorry, didn\u0027t notice you\u0027re checking both.\n\nSo for boot/vbmeta, valid_uevent is always false, right?\nBecause boot/vbmeta isn\u0027t in the fstab-dt.",
      "parentUuid": "9be47054_d18df9c0",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6c6695bf_cf4fe57c",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T05:50:11Z",
      "side": 1,
      "message": "Yes.  valid_uevent alway retuen false if we do add boot/vbmeta in device tree.",
      "parentUuid": "ac58c5e3_0f0e95de",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c02df1f9_29e32d1d",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T08:47:33Z",
      "side": 1,
      "message": "If so, I wonder how this can work?\n\nThat means vbmeta/boot aren\u0027t added in the the following by_name_symlink_map_.",
      "parentUuid": "6c6695bf_cf4fe57c",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "97e3736d_6f273746",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T09:02:54Z",
      "side": 1,
      "message": "we only mount the vendor partition in first stage now.\nAnd we do not enable verify work for vendor partition.\nWhere is vbmeta/boot defined in your env?",
      "parentUuid": "c02df1f9_29e32d1d",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "24d1ec76_6911e6cd",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-01-17T09:11:20Z",
      "side": 1,
      "message": "Then it\u0027s weird.\n\nWhy the code goes into this function?\nFirstStageMountVBootV2::UeventCallback().\n\nYou should have vbmeta settings in device tree.\nstatic inline bool IsDtVbmetaCompatible() {                                                                                                                                  \n    return is_android_dt_value_expected(\"vbmeta/compatible\", \"android,vbmeta\"); \n}",
      "parentUuid": "97e3736d_6f273746",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c1ef523f_f8823396",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 4
      },
      "lineNbr": 425,
      "author": {
        "id": 1103773
      },
      "writtenOn": "2018-01-17T09:18:36Z",
      "side": 1,
      "message": "Yes. We enable FirstStageMountVBootV2 through add below in dts.\n35\t\t\t\t/*we need use FirstStageMountVBootV2 if we enable avb*/\n36\t\t\t\tcompatible \u003d \"android,vbmeta\";\n37\t\t\t\t/*parts means the partition witch can be mount in first stage*/\n38\t\t\t\tparts \u003d",
      "parentUuid": "24d1ec76_6911e6cd",
      "range": {
        "startLine": 425,
        "startChar": 20,
        "endLine": 425,
        "endChar": 33
      },
      "revId": "3f5c4d0db5e9f3aa9d456e7a51a52a9be64286e5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}