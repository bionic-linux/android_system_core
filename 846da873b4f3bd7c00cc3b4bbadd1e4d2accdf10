{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "28e28fca_43f36a9b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2022-07-15T18:10:15Z",
      "side": 1,
      "message": "FYI want to merge this patch by itself, since that makes dealing with downstream branches easier.",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a6f650a_0879e202",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1809421
      },
      "writtenOn": "2022-07-15T20:11:54Z",
      "side": 1,
      "message": "This increases the privileges available to storageproxy after booting up though, right? We were already running as system, but we don\u0027t need full system caps, afaiu.",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "236e8480_e1e1360a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2022-07-15T20:23:29Z",
      "side": 1,
      "message": "Currently, storageproxyd starts as root user, then deprivileges. It also requires setuid and setgid SELinux permission. \n\naosp/2154894 is the other half of this. It changes it so that storageproxyd starts as system user. storageproxyd is unable to do capset with this though. \n\nSame change will be needed for other devices too.",
      "parentUuid": "0a6f650a_0879e202",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1fd4d4c3_c8d22acb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1809421
      },
      "writtenOn": "2022-07-15T20:26:13Z",
      "side": 1,
      "message": "Does system have more capabilities than `CAP_SYS_RAW_IO`?",
      "parentUuid": "236e8480_e1e1360a",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c9340366_04631bb2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2022-07-15T20:42:40Z",
      "side": 1,
      "message": "https://android.googlesource.com/platform/system/core/+/master/init/README.md#options says, \"If no capabilities are provided, then all capabilities are removed from this service, even if it runs as root.\" \n\nSo, with this change storageproxyd wouldn\u0027t even have `CAP_SYS_RAW_IO`. I looked at /proc/\u003cpid\u003e/status. And `CAP_SYS_RAW_IO` indeed went away.\n\nI played around with fingeprint on a real device, and that works. \n\nDo you know if `CAP_SYS_RAW_IO` is required?",
      "parentUuid": "1fd4d4c3_c8d22acb",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd1fa235_90e4d3c3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1809421
      },
      "writtenOn": "2022-07-15T21:31:52Z",
      "side": 1,
      "message": "I thought we need it for SCSI commands for RPMB, it\u0027s possible we don\u0027t need it for the UFS commands now, but we still have a legacy path with MMC commands.",
      "parentUuid": "c9340366_04631bb2",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a508223f_e2bbd889",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2022-07-15T21:52:49Z",
      "side": 1,
      "message": "I see. If that\u0027s the case, I feel like we should also rely on init.rc to set up capabilities for storageproxyd. I wonder now why fingerprint works on my device.",
      "parentUuid": "fd1fa235_90e4d3c3",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "106ed909_7f98b079",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1809421
      },
      "writtenOn": "2022-07-15T22:03:20Z",
      "side": 1,
      "message": "We don\u0027t currently use MMC on any device that I know of for the RPMB operations so that might be it. Maybe we can remove it?",
      "parentUuid": "a508223f_e2bbd889",
      "revId": "846da873b4f3bd7c00cc3b4bbadd1e4d2accdf10",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}