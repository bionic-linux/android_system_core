{
  "comments": [
    {
      "key": {
        "uuid": "9bc3f9a8_cb20321b",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 642,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2018-11-30T17:03:15Z",
      "side": 1,
      "message": "update-engine is hard coded to use ext4 on system_b alternate, overlayfs lands f2fs if tools are available to keep flash wear down and this conflicts. overlayfs will mount ext4 or f2fs, it does not care.",
      "range": {
        "startLine": 637,
        "startChar": 0,
        "endLine": 642,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c3a228b_babc527b",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 642,
      "author": {
        "id": 1056365
      },
      "writtenOn": "2018-11-30T17:38:52Z",
      "side": 1,
      "message": "For the \"update-engine\" here, did you mean the system/extras/cppreopts/cppreopts.rc in your previous comment? If so, that doesn\u0027t relate to update_engine. cpppreopts is called on a fresh boot (i.e. out-of-box, or after factory reset). Failing to finish that doesn\u0027t fail boot or OTA.\n\n(An unrelated question is maybe that mount is probably broken with DAP? Either on retrofit or native DAP, or even both...)",
      "parentUuid": "9bc3f9a8_cb20321b",
      "range": {
        "startLine": 637,
        "startChar": 0,
        "endLine": 642,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d068fdab_11a4f4ce",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 642,
      "author": {
        "id": 1056365
      },
      "writtenOn": "2018-11-30T17:47:37Z",
      "side": 1,
      "message": "For the \"unrelated question\", found it\u0027s already being tracked in b/113182233: retrofit device is fine, since system_b is non-logical at the point of first boot. The mount in DAP world needs additional works.",
      "parentUuid": "7c3a228b_babc527b",
      "range": {
        "startLine": 637,
        "startChar": 0,
        "endLine": 642,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d0599dd2_ec658652",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 783,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2018-11-30T17:03:15Z",
      "side": 1,
      "message": "A) is this OK, or is there an alternate better way of telling if we are in recovery or fastbootd?\nB) is there a way we can tell if update-engine _owns_ alternate super?",
      "range": {
        "startLine": 777,
        "startChar": 4,
        "endLine": 783,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc9e87ef_ed5b3556",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 783,
      "author": {
        "id": 1056365
      },
      "writtenOn": "2018-11-30T17:38:52Z",
      "side": 1,
      "message": "For A), maybe check fastbootd service state?",
      "parentUuid": "d0599dd2_ec658652",
      "range": {
        "startLine": 777,
        "startChar": 4,
        "endLine": 783,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbaa9149_0707f5d1",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 783,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-11-30T19:02:03Z",
      "side": 1,
      "message": "What exactly are you trying to check for here?  Just that you\u0027re in recovery/fastbootd?  You can check for the presence of /system/bin/recovery like we do in init and fs_mgr already, https://cs.corp.google.com/android/system/core/init/first_stage_mount.cpp?type\u003dcs\u0026q\u003d%22/system/bin/recovery%22\u0026sq\u003dpackage:%5Eandroid$\u0026g\u003d0\u0026l\u003d128.\n\nforce_normal_boot causes first stage init to chroot to a clean root environment almost immediately upon booting, so everything should be identical to the normal ramdisk boot before fs_mgr is ever called.  In other words, you should never need to check force_normal_boot.",
      "parentUuid": "bc9e87ef_ed5b3556",
      "range": {
        "startLine": 777,
        "startChar": 4,
        "endLine": 783,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42086ba1_1b59195a",
        "filename": "fs_mgr/fs_mgr_overlayfs.cpp",
        "patchSetId": 5
      },
      "lineNbr": 783,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2018-11-30T22:19:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cbaa9149_0707f5d1",
      "range": {
        "startLine": 777,
        "startChar": 4,
        "endLine": 783,
        "endChar": 0
      },
      "revId": "d745ef3038ee1aaebaeb0c11b34756b63723ac27",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}