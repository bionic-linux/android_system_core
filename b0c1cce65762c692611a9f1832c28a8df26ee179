{
  "comments": [
    {
      "key": {
        "uuid": "1dd53033_4011f36f",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "keep const on first arg?\n\nnit: line too long?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dd5398c8_23962a02",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1dd53033_4011f36f",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bdc1846e_09d435be",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 50,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "What about 3072? It could be a nice alternative if 4096 has poor performance.",
      "range": {
        "startLine": 50,
        "startChar": 26,
        "endLine": 50,
        "endChar": 30
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d0cc0ef_39c54fae",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 50,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "That\u0027s a good question. I feel it\u0027s a slippery slope, though... that, and boot time performance is probably less sensitive on IoT compared to phones and laptops...",
      "parentUuid": "bdc1846e_09d435be",
      "range": {
        "startLine": 50,
        "startChar": 26,
        "endLine": 50,
        "endChar": 30
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd0fc4b0_aa3d2477",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: 2 * h.key_num_bits / 8 is more clear (and is used above also, maybe put in a descriptive var?)",
      "range": {
        "startLine": 66,
        "startChar": 57,
        "endLine": 66,
        "endChar": 61
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5dede836_fff0df47",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 66,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd0fc4b0_aa3d2477",
      "range": {
        "startLine": 66,
        "startChar": 57,
        "endLine": 66,
        "endChar": 61
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ddc9d89d_f501cb9d",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 72,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "optional: key-\u003en \u003d (uint32_t *) (key + 1); is more succinct (although maybe not as obvious)?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7deaac21_6096f202",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 72,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "That\u0027ll work but I prefer the more explicit version.",
      "parentUuid": "ddc9d89d_f501cb9d",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3d4834fd_52a8c44f",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 73,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "key-\u003err \u003d key-\u003en + key-\u003elen;",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd0984df_ba2f9186",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 73,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3d4834fd_52a8c44f",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3dacb4b4_68e96cfc",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 76,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "The documentation for the image describes a big-endian number but this is documented as little endian. In that case, this code should also reverse the order of all the uint32_t\u0027s? Or is the documentation wrong? Is it a big-endian number composed of host-endian words?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bde0a43d_e29166ce",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 76,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "The on-disk data is defined to be most-significant-bit first because that\u0027s the format I decided on since it\u0027s natural, simple to explain and mentally parse (using e.g. hexdump(1)), and actually doesn\u0027t involve specifying endianness... [0].\n\nThe code I inherited from vboot_reference (which is using the Key struct that I convert the on-disk key format into here) seems to be somewhat little-endian centric [1] so that\u0027s why there\u0027s this conversion step... I could probably nuke the conversion step here if I did the requisite changes to subM(), geM(), montMulAdd(), montMul(), modpowF4() below ... but that goes against my wish of trying to change as little as possible from the inherited code (and against the general doctrine of \"don\u0027t write your own crypto).\n\nI would prefer to leave things as is (that is, don\u0027t change any crypto) for now and possibly revisit it later if needed. FWIW, I don\u0027t think this code - in Brillo nor CrOS - currently work on big-endian... but that\u0027s another problem for another day, I think :-)\n\n[0] : well, except you could say that the entire 256-byte \"word\" for the 2048 bits is encoded as big endian ... I actually use that language in bvbtool\u0027s write_long() function which is what writes the stuff to disk.\n\n[1] : the on-disk format used in CrOS certainly *appears* to be little-endian... TBH, it doesn\u0027t look like the encoding is specified anywhere which is somewhat disconcerting...",
      "parentUuid": "3dacb4b4_68e96cfc",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1da7f0d2_92506ad9",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 160,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: consistency w/ \u0027a \u003d\u003d NULL\u0027 statements elsewhere",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d0cc0ef_59f803da",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 160,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1da7f0d2_92506ad9",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3dacb4b4_28800421",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 161,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "log in this case and free any successful allocs (like verify below)?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bde0a43d_429772c0",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 161,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Not sure logging will work if we\u0027re OOM. I\u0027ll replace the return with goto out instead.",
      "parentUuid": "3dacb4b4_28800421",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ddc9d89d_958df760",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 225,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: spaces around *",
      "range": {
        "startLine": 225,
        "startChar": 39,
        "endLine": 225,
        "endChar": 40
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d0cc0ef_b9231f42",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 225,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ddc9d89d_958df760",
      "range": {
        "startLine": 225,
        "startChar": 39,
        "endLine": 225,
        "endChar": 40
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7df0ecdc_708cc5f1",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 255,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "hash_num_bytes (length consistency already verified above)",
      "range": {
        "startLine": 255,
        "startChar": 53,
        "endLine": 255,
        "endChar": 86
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1d5a90dd_a591bece",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 255,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "yeah, that\u0027s nicer... doing that.",
      "parentUuid": "7df0ecdc_708cc5f1",
      "range": {
        "startLine": 255,
        "startChar": 53,
        "endLine": 255,
        "endChar": 86
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bde6e426_1e246a48",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 260,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: double-space",
      "range": {
        "startLine": 260,
        "startChar": 9,
        "endLine": 260,
        "endChar": 11
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dd5398c8_8307def7",
        "filename": "bvb/bvb_rsa.c",
        "patchSetId": 5
      },
      "lineNbr": 260,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bde6e426_1e246a48",
      "range": {
        "startLine": 260,
        "startChar": 9,
        "endLine": 260,
        "endChar": 11
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdce9ca2_74737db8",
        "filename": "bvb/bvb_sha.h",
        "patchSetId": 5
      },
      "lineNbr": 48,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: lower case for consistency?",
      "range": {
        "startLine": 48,
        "startChar": 9,
        "endLine": 48,
        "endChar": 12
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdfdbce9_5c6d9dce",
        "filename": "bvb/bvb_sha.h",
        "patchSetId": 5
      },
      "lineNbr": 48,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fdce9ca2_74737db8",
      "range": {
        "startLine": 48,
        "startChar": 9,
        "endLine": 48,
        "endChar": 12
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d8c6c87_d0983ca7",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "Looks like this macro could just as well be a class method?",
      "range": {
        "startLine": 25,
        "startChar": 8,
        "endLine": 25,
        "endChar": 22
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3df4b401_1e3aedcc",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 25,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Unfortunately not, it needs to be a macro to give the right file/line information.",
      "parentUuid": "7d8c6c87_d0983ca7",
      "range": {
        "startLine": 25,
        "startChar": 8,
        "endLine": 25,
        "endChar": 22
      },
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dd255844_3347481d",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "nit: override destructor?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7deaac21_6044323f",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dd255844_3347481d",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3d76744b_b1181abb",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 83,
      "author": {
        "id": 1079236
      },
      "writtenOn": "2016-02-16T21:59:10Z",
      "side": 1,
      "message": "base::DeleteFile?",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd0984df_5a02b5ec",
        "filename": "bvb/bvb_unittest_util.h",
        "patchSetId": 5
      },
      "lineNbr": 83,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-02-17T23:09:08Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3d76744b_b1181abb",
      "revId": "b0c1cce65762c692611a9f1832c28a8df26ee179",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}