{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "896c1082_bde54db6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1963052
      },
      "writtenOn": "2022-08-30T19:57:41Z",
      "side": 1,
      "message": "Hi Ray Chi,\n\nCan you re-review the latest patch?\n\nThanks!",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f5c7f362_4363a6ec",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2022-09-06T18:37:48Z",
      "side": 1,
      "message": "Recently we started moving to fastbootd to io_uring. Adding zhangkelvin@ and akailash@ to see if we need to adjust usb_ffs_do_aio() in usb_iouring.cpp as well.",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9016bef2_38153a49",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2022-09-06T20:02:50Z",
      "side": 1,
      "message": "This code path was changed recently to use io_uring. We should probably fix that as well.",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "948fef3b_550c746e",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1963052
      },
      "writtenOn": "2022-09-06T20:12:13Z",
      "side": 1,
      "message": "Hi Akilesh,\nIf you point me where the new code is, I can probably append the changes to this patch.\nThanks!",
      "parentUuid": "9016bef2_38153a49",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4ddb9400_ffb3def0",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2022-09-06T20:17:31Z",
      "side": 1,
      "message": "That would be here:\n\nhttps://source.corp.google.com/aosp-master/system/core/fastboot/device/usb_iouring.cpp;l\u003d94\n\nI had this question of retrying in the original CL:\n\nhttps://android-review.googlesource.com/c/platform/system/core/+/2151839/17..21/fastboot/device/usb_iouring.cpp#b98\n\nIt looks like on EPIPE, we do retry today; but it would be good to re-validate.",
      "parentUuid": "948fef3b_550c746e",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "362d0492_6d5a6a0d",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1963052
      },
      "writtenOn": "2022-09-06T20:24:44Z",
      "side": 1,
      "message": "Hmm looks like it\u0027s more involving than I thought...\nIf I understand correctly, today\u0027s code uses the iouring path?",
      "parentUuid": "4ddb9400_ffb3def0",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52c4e76b_c3257800",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2022-09-06T20:36:47Z",
      "side": 1,
      "message": "I looked at the original adb code; over there we track the first request by \"connection_started_\" variable. How do we do this here ? This sounds like we are retrying for every EPIPE event which is not what we intend to do ?",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f23e8bc7_96994c3b",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2022-09-06T20:36:47Z",
      "side": 1,
      "message": "It has been enabled only on Pixel 6 devices to start-off; but eventually it will be enabled on other devices which has 5.10+ kernels.\n\nEnabling is controlled by the property: sys.usb.ffs.io_uring_enabled\n\nhttps://googleplex-android-review.git.corp.google.com/c/device/google/gs101/+/19774913",
      "parentUuid": "362d0492_6d5a6a0d",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e5296f7d_188e6dfe",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 164,
      "author": {
        "id": 1590325
      },
      "writtenOn": "2022-09-07T07:32:57Z",
      "side": 1,
      "message": "\u0027connection_started_\u0027 is a flag that the device is already connected or not. In the line of this while loop, if the device is not connected, it will be stopped at line 152 and line 156. Therefore, I think we can ignore this flag here.",
      "parentUuid": "52c4e76b_c3257800",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b6c0c37_8aa40c4e",
        "filename": "fastboot/device/usb.cpp",
        "patchSetId": 3
      },
      "lineNbr": 166,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2022-09-06T20:36:47Z",
      "side": 1,
      "message": "s/adb/fastboot",
      "revId": "c8017ddcd0536a1bec9be35ed5645cbc5f1319d5",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}