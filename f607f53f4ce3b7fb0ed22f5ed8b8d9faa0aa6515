{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fea87090_199e4f9f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2022-02-14T23:25:36Z",
      "side": 1,
      "message": "The patch does two things: introducing new attribute and adding a test.\nI think it would be better to split the test into a separate patch.",
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2e82f99d_5915afa4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1869780
      },
      "writtenOn": "2022-02-15T00:27:23Z",
      "side": 1,
      "message": "From https://engdoc.corp.google.com/eng/doc/devguide/testing/unit/overview.md?cl\u003dhead: \"Unit tests are tightly coupled with the code being tested and are submitted in the same CL.\"\n\nPlease reopen this comment if you want me to separate the unit test from the introduction of the support for optional attributes.",
      "parentUuid": "fea87090_199e4f9f",
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cd51a7a2_e91537cc",
        "filename": "libprocessgroup/task_profiles.cpp",
        "patchSetId": 6
      },
      "lineNbr": 211,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2022-02-14T23:25:36Z",
      "side": 1,
      "message": "When attr_exists\u003d\u003dfalse why do you need to call WriteStringToFile? To set a cgroup attribute that attribute should exist. If it doesn\u0027t exist then the operation should fail unless it\u0027s optional. Suggest:\n\nif (access(path.c_str(), 0600) \u0026\u0026 optional_) {\n    return true;\n}\n\nif (!WriteStringToFile(value_, path)) {\n    PLOG(ERROR) \u003c\u003c \"Failed to write \u0027\" \u003c\u003c value_ \u003c\u003c \"\u0027 to \" \u003c\u003c path;\n    return false;\n}\n\nreturn true;",
      "range": {
        "startLine": 211,
        "startChar": 4,
        "endLine": 211,
        "endChar": 43
      },
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e8e91f0d_02a4669b",
        "filename": "libprocessgroup/task_profiles.cpp",
        "patchSetId": 6
      },
      "lineNbr": 211,
      "author": {
        "id": 1869780
      },
      "writtenOn": "2022-02-15T00:27:23Z",
      "side": 1,
      "message": "The WriteStringToFile() does not create an attribute but instead writes into an existing attribute. Creating cgroup attributes from user space is not possible as far as I know. The suggested alternative is not correct since it skips the WriteStringToFile() call if an attribute is optional and exists. \n\nPlease reopen this comment with another suggestion if you want me to change the code.",
      "parentUuid": "cd51a7a2_e91537cc",
      "range": {
        "startLine": 211,
        "startChar": 4,
        "endLine": 211,
        "endChar": 43
      },
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "016a1482_1bf9a6e8",
        "filename": "libprocessgroup/task_profiles.cpp",
        "patchSetId": 6
      },
      "lineNbr": 211,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2022-02-15T00:53:44Z",
      "side": 1,
      "message": "Correct, WriteStringToFile() will fail if access() indicates that the file is missing. My question is: why do we need to call WriteStringToFile() if we know it will fail?\n\nre: The suggested alternative is not correct since it skips the WriteStringToFile() call if an attribute is optional and exists. \n\nI think it will skip WriteStringToFile() if attribute is optional and it doesn\u0027t exist. And I think that is what we want. No?",
      "parentUuid": "e8e91f0d_02a4669b",
      "range": {
        "startLine": 211,
        "startChar": 4,
        "endLine": 211,
        "endChar": 43
      },
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1921dc2d_dc6603d1",
        "filename": "libprocessgroup/task_profiles.cpp",
        "patchSetId": 6
      },
      "lineNbr": 211,
      "author": {
        "id": 1869780
      },
      "writtenOn": "2022-02-16T01:36:42Z",
      "side": 1,
      "message": "The code has been modified such that WriteStringToFile() is no longer called for optional attributes if the attribute does not exist. Please reopen this comment thread if you want me to make further changes to this code.\n\nAs one can see the current code still calls WriteStringToFile() even if access() indicates that the attribute does not exist. This is because the PLOG() statements below WriteStringToFile() depend on the errno value produced by WriteStringToFile.",
      "parentUuid": "016a1482_1bf9a6e8",
      "range": {
        "startLine": 211,
        "startChar": 4,
        "endLine": 211,
        "endChar": 43
      },
      "revId": "f607f53f4ce3b7fb0ed22f5ed8b8d9faa0aa6515",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}