{
  "comments": [
    {
      "key": {
        "uuid": "255d9b65_e622e31f",
        "filename": "base/logging.cpp",
        "patchSetId": 6
      },
      "lineNbr": 96,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2018-04-06T22:02:35Z",
      "side": 1,
      "message": "NB: may block(?) for selinux audit messages, but if it does it means this operation is going to return EPERM anyways so still agree no need for TEMP_FAILURE_RETRY.",
      "range": {
        "startLine": 96,
        "startChar": 10,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "e2c7f61d63ec5d0f5787e4b87bad466c1073058c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0ed42278_e2869ecf",
        "filename": "base/logging.cpp",
        "patchSetId": 6
      },
      "lineNbr": 96,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-04-06T22:22:17Z",
      "side": 1,
      "message": "Per the man page, fcntl with F_GETFL will not fail with EINTR, which is what we care about with TEMP_FAILURE_RETRY().\n\nThis line is a little bit scary since if fcntl() fails it returns -1.  It will fail the check after the mask luckily so it\u0027s safe, but perhaps not straight-forward to read.  Something like \n\nauto fl_result \u003d fcntl(...);\nif (fl_result !\u003d -1 \u0026\u0026 (fl_result \u0026 O_ACCMODE) \u003d\u003d O_WRONLY)) ...\n\nwould make it clear that we\u0027re doing the first check.",
      "parentUuid": "255d9b65_e622e31f",
      "range": {
        "startLine": 96,
        "startChar": 10,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "e2c7f61d63ec5d0f5787e4b87bad466c1073058c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "599db61f_7c6df037",
        "filename": "base/logging.cpp",
        "patchSetId": 6
      },
      "lineNbr": 96,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2018-04-06T22:26:32Z",
      "side": 1,
      "message": "O_ACCMODE by _design_ will result in an illegal open mode for value of -1 (SysVr3 source license and maintenance taught me this in the \u002780s).\n\nIf it bothers you, it can bother someone else, so will change it.",
      "parentUuid": "0ed42278_e2869ecf",
      "range": {
        "startLine": 96,
        "startChar": 10,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "e2c7f61d63ec5d0f5787e4b87bad466c1073058c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2847972e_87fd1f50",
        "filename": "base/logging.cpp",
        "patchSetId": 6
      },
      "lineNbr": 96,
      "author": {
        "id": 1130394
      },
      "writtenOn": "2018-04-06T23:48:59Z",
      "side": 1,
      "message": "\u003e O_ACCMODE by _design_ will result in an illegal open mode for value of -1\n\nSeems clear enough to me, FWIW. It\u0027s pretty clear that O_WRONLY can\u0027t be -1. (POSIX explicitly requires two\u0027s complement representation of integers, forcing -1 to be all one bits, making it useless as a bitwise flag.)\n\n\u003e selinux audit messages\n\nTASK_UNINTERRUPTIBLE though, so any blocking isn\u0027t observable at the system call boundary.",
      "parentUuid": "599db61f_7c6df037",
      "range": {
        "startLine": 96,
        "startChar": 10,
        "endLine": 96,
        "endChar": 28
      },
      "revId": "e2c7f61d63ec5d0f5787e4b87bad466c1073058c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}