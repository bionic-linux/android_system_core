{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ba96ab1c_d8faea60",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-04-30T11:37:51Z",
      "side": 1,
      "message": "Hi Keun-young, \n\nCould you look into the thread and share your thoughts?",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cb23a4bd_9c1a0e7a",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-04-30T09:04:04Z",
      "side": 1,
      "message": "Why can\u0027t F2FS use the existing log file (just above)?",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "95fbb7e4_3f2996af",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1176763
      },
      "writtenOn": "2022-04-30T09:28:06Z",
      "side": 1,
      "message": "https://b.corp.google.com/issues/230637147#comment7\n\nThat\u0027s not persistent.",
      "parentUuid": "cb23a4bd_9c1a0e7a",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a2aed131_bb7985fe",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-04-30T09:45:32Z",
      "side": 1,
      "message": "Hmm, actually I don\u0027t understand the rationale behind https://android-review.googlesource.com/c/platform/system/core/+/1943364\n\nb/210589189 doesn\u0027t seem to say anything about the reason why f2fs shouldn\u0027t be using the log file.\n\nMore fundamentally, could you please explain why we are okay with the log file being non-persistent when ext4 is used, but would like to keep the log for f2fs? What prevents us from having consistency across ext4 and f2fs regarding the log file?",
      "parentUuid": "95fbb7e4_3f2996af",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83314997_39daa526",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1176763
      },
      "writtenOn": "2022-04-30T10:12:15Z",
      "side": 1,
      "message": "I don\u0027t see any benefit to keep the temp fscklog in f2fs, which was used only for ext4. See https://android.googlesource.com/platform/frameworks/base/+/e0b0bef/services/core/java/com/android/server/BootReceiver.java#247.\n\nPlease chime in, if there\u0027s any user to collect it, since there should have no report with f2fs for a long time. If there\u0027s no user, I\u0027d say we need to remove that obsolete code.\n\nOn the other hands, I realized that, it\u0027d be better to record the log in the bug report, which will be useful for debugging. Hence, I added another one.",
      "parentUuid": "a2aed131_bb7985fe",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8330a372_93f43367",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-04-30T10:26:16Z",
      "side": 1,
      "message": "Sorry, but what you said doesn\u0027t explain the reason for such an inconsistent handling of log. If you think there\u0027s no benefit to keep the log in fsf2, why do you want to keep it for ext4? Why don\u0027t we drop the log for both filesystems?",
      "parentUuid": "83314997_39daa526",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b2aefc87_8282eb3e",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1176763
      },
      "writtenOn": "2022-04-30T10:41:22Z",
      "side": 1,
      "message": "I\u0027m saying I\u0027d like to kill it in both ext4 and f2fs. But, I couldn\u0027t do it for ext4, since I don\u0027t know who is using the stat. And, it requires lots of code changes such as selinux, BootReceiver, and so on.\n\nSo, I was thinking two approaches:\n1) keep fscklog for ext4 and f2fs, but remove BootReceiver report to keep the log for bug report.\n2) keep fscklog for ext4 along with BootReceiver, but add another log for f2fs only.",
      "parentUuid": "8330a372_93f43367",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc16e3b3_bd37dbf1",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-04-30T11:37:51Z",
      "side": 1,
      "message": "Ok, I think I now understand this a bit better. So far, even before aosp/1943364, the log from fsck.f2fs wasn\u0027t correctly handled by BootReceiver because the log has a format different from that of e2fsck. For example, log from fsck.f2fs doesn\u0027t have the \"FILE SYSTEM WAS MODIFIED\" marker that BootReceiver is looking for. I think that IS a regression caused by the migration to f2fs. BootReceiver should have amended to understand the logs from both of the fsck programs.\n\nOddly enough, nobody has complained about the regression. Therefore, you\u0027d like to \"officially\" drop the support for it at least for f2fs.\n\nHowever, I doubt if nobody will really be unhappy with this... given that f2fs became mandatory just for T as you said in aosp/2082091. As f2fs becomes more widely used in the ecosystem, somebody will complain?\n\nWhen I read bugs like b/35329915, it looks like we have wanted to gather more info from the fsck log. Therefore, it\u0027s hard to think that we stopped wanting it simply because we have switched to f2fs. On the other hand, it\u0027s been 5 years, so I wouldn\u0027t be surprised if we have changed our mind. I just don\u0027t know.\n\nLet me invite keunyoung@ who filed and fixed b/35329915 to check if this is a regression or an obsolete feature (regardless of filesystem type).",
      "parentUuid": "b2aefc87_8282eb3e",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e590beae_d9d2ebc7",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1041495
      },
      "writtenOn": "2022-05-02T06:35:34Z",
      "side": 1,
      "message": "\u003e However, I doubt if nobody will really be unhappy with this\n\nLooks like this change sprung from b/230637147, which is just me asking \"what does bug 210589189 say?\", and why aosp/1943364 did what it did. We didn\u0027t have access to that issue, and the commit message contained no details (an unfortunately common dilemma for those of us working on Android outside Google), so we couldn\u0027t determine whether the change was solving some observed _problem_ that we might risk reintroducing, or if it was just a matter of cleanup.\n\nThe background for wanting to know is that we\u0027ve carried a patch since Q where we also store f2fs fsck logs inside /dev/fscklogs/, with a filename based on the block device name (so as to keep logs for multiple filesystems). So there you have at least one data point for wanting to keep the logs even for f2fs. We do.",
      "parentUuid": "dc16e3b3_bd37dbf1",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f566109b_53320269",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1010465
      },
      "writtenOn": "2022-05-02T16:32:27Z",
      "side": 1,
      "message": "BootReceiver is doing two things: add fsck error to metrics and upload the file to drop box. \nThe metrics portion is mote critical and will be good if it is supported from f2fs.",
      "parentUuid": "e590beae_d9d2ebc7",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "851d445b_29e347a4",
        "filename": "fs_mgr/fs_mgr.cpp",
        "patchSetId": 3
      },
      "lineNbr": 85,
      "author": {
        "id": 1176763
      },
      "writtenOn": "2022-05-02T22:11:58Z",
      "side": 1,
      "message": "Can I get how to retrieve the metrics?\n\nRe: I updated this CL to support f2fs back, and posted BootReceiver to keep the fsck log for bug report.",
      "parentUuid": "f566109b_53320269",
      "revId": "df7250bbe05611232f85b57e18cd818d3ed8a308",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}