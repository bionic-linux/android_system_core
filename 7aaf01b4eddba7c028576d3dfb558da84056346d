{
  "comments": [
    {
      "key": {
        "uuid": "1b5b914d_3cbae900",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1105075
      },
      "writtenOn": "2019-04-09T16:38:47Z",
      "side": 1,
      "message": "isn\u0027t this is intended to boost more important threads?\n\n\nbtw, in screen off, cpuset will be changed to restricted when schedtune remains TA.\n\n5:schedtune:/top-app\n4:memory:/\n3:cpuset:/restricted\n2:cpuacct:/uid_10086/pid_5119\n1:cpu:/",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1cb6842a_80e8c005",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1324603
      },
      "writtenOn": "2019-04-10T03:03:03Z",
      "side": 1,
      "message": "Yes, I understand that some services may have different settings for their cpuset and stune groups, but for app\u0027s case, if it is already in top-app, then changing its stune group can only lower its priority because top-app is the highest for now (I know there is \"rt\" group for stune, but it is not taking effect currently). And also we only have \"root\" and \"background\" group for blkio, so as long as the task\u0027s cpuset is not set to \"background\" group while it is in top-app, then it should be fine (this also applies for \"restricted\" group while screen off).",
      "parentUuid": "1b5b914d_3cbae900",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8cc5f44f_72c1c02e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1105075
      },
      "writtenOn": "2019-04-10T04:23:41Z",
      "side": 1,
      "message": "even if the thread is not UI/render thread which is latency sensitive? In another word, this is to boost the whole app or only part of it?",
      "parentUuid": "1cb6842a_80e8c005",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2401ac94_daffb6d6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1324603
      },
      "writtenOn": "2019-04-10T06:39:12Z",
      "side": 1,
      "message": "I\u0027m not quite sure if I follow you correctly, so please forgive me if I didn\u0027t describe it clearly. The case is that an app which has many threads is top-app. It\u0027s main threads (including UI/render thread) are set to \"top-app\" for both cpuset and stune group by calling set_cpuset_policy(), but some thread will set stune group to \"background\" for itself by calling set_sched_policy() again (I won\u0027t say this is to boost it :)). In current design, it will also set blkio group to \"background\" of that thread. However, I found the thread will do IO related to UX, so if there is busy IO in blkio \"root\" group, then the response will be slow of that app. That\u0027s the reason I think we should change blkio group in set_cpuset_policy() only, which reflects the current status of the app.",
      "parentUuid": "8cc5f44f_72c1c02e",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d74aaef8_659589dd",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1105075
      },
      "writtenOn": "2019-04-11T03:54:29Z",
      "side": 1,
      "message": "that\u0027s what I meant, isn\u0027t this expected if an app explicitly called set_sched_policy to set a thread to background. \nI found the thread will do IO related to UX\" makes me feel it should not set that thread to bg.",
      "parentUuid": "2401ac94_daffb6d6",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f0d81b97_a46aa917",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1324603
      },
      "writtenOn": "2019-04-11T06:23:43Z",
      "side": 1,
      "message": "Got your point. We don\u0027t know the reason why the app do so, but we can track this part since it is our own settings app. However, we cannot avoid this behavior if it happens in other apps, so IMHO, we may still need this patch to prevent bad things happening.",
      "parentUuid": "d74aaef8_659589dd",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a59fad43_4c75c4e5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1105075
      },
      "writtenOn": "2019-04-11T06:33:26Z",
      "side": 1,
      "message": "depends how bad it is. can we move into the bug and understand the data?",
      "parentUuid": "f0d81b97_a46aa917",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f312c554_e0763592",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1324603
      },
      "writtenOn": "2019-04-11T08:17:05Z",
      "side": 1,
      "message": "sure, I put more detail in b/117857342#67.",
      "parentUuid": "a59fad43_4c75c4e5",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 17,
        "endChar": 0
      },
      "revId": "7aaf01b4eddba7c028576d3dfb558da84056346d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}