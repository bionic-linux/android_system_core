{
  "comments": [
    {
      "key": {
        "uuid": "8563fcf4_80926b9c",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1081223
      },
      "writtenOn": "2020-02-11T16:38:45Z",
      "side": 1,
      "message": "Why not use std::filesystem?\n\n```\n    std::error_code ec;\n\n    // Removing existing keys in gsi::kDsuAvbKeyDir as they might be stale.\n    std::filesystem::remove_all(gsi::kDsuAvbKeyDir, ec);\n    if (ec) {\n        PLOG(ERROR) \u003c\u003c \"Failed to remove directory \" \u003c\u003c gsi::kDsuAvbKeyDir;\n    }\n\n    // Copy keys from the ramdisk /avb/* to gsi::kDsuAvbKeyDir.\n    static constexpr char kRamdiskAvbKeyDir[] \u003d \"/avb\";\n    std::filesystem::copy(kRamdiskAvbKeyDir, gsi::kDsuAvbKeyDir, ec);\n    if (ec) {\n        PLOG(ERROR) \u003c\u003c \"Failed to copy \" \u003c\u003c kRamdiskAvbKeyDir \u003c\u003c \" into \" \u003c\u003c gsi::kDsuAvbKeyDir;\n    }\n```\nIt\u0027s much simpler imo and libc++fs is already included",
      "range": {
        "startLine": 683,
        "startChar": 0,
        "endLine": 720,
        "endChar": 5
      },
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35d8b2a5_58c71a90",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2020-02-11T21:53:32Z",
      "side": 1,
      "message": "Does libc++fs set the |errno|? If not then we shouldn\u0027t be using PLOG here.",
      "parentUuid": "8563fcf4_80926b9c",
      "range": {
        "startLine": 683,
        "startChar": 0,
        "endLine": 720,
        "endChar": 5
      },
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4add59b4_7f773d6c",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1081223
      },
      "writtenOn": "2020-02-11T21:55:01Z",
      "side": 1,
      "message": "typo on my side",
      "parentUuid": "35d8b2a5_58c71a90",
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3c09b1e3_78f95358",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2020-02-12T02:17:49Z",
      "side": 1,
      "message": "Thanks for the suggestion (just didn\u0027t think about it).\nI\u0027m ok with that but it seems std::filesystem isn\u0027t widely used here.\n\nLet\u0027s see Yo or Tom\u0027s thought on this.",
      "parentUuid": "4add59b4_7f773d6c",
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f6ccf954_cd8270b3",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2020-02-12T02:20:33Z",
      "side": 1,
      "message": "std::filesystem sounds like a win to me.  We do use it in a handful of cases already, so we should get into the habit of using it more.",
      "parentUuid": "3c09b1e3_78f95358",
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "92a53e94_4b35036a",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2020-02-12T02:37:05Z",
      "side": 1,
      "message": "Ack!",
      "parentUuid": "f6ccf954_cd8270b3",
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a326be5c_191ccd7b",
        "filename": "init/first_stage_mount.cpp",
        "patchSetId": 2
      },
      "lineNbr": 720,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2020-02-12T02:39:42Z",
      "side": 1,
      "message": "To me it\u0027s more a choice of coding style. I don\u0027t have a strong preference between the c-style \u003cdirent.h\u003e or cpp-style \u003cfilesystem\u003e. Both works IMO.",
      "parentUuid": "f6ccf954_cd8270b3",
      "revId": "e70f11b21ae3fe3d0e15afa9b10d6eef689fbb85",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}