{
  "comments": [
    {
      "key": {
        "uuid": "eff0854b_f9b45b7f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-02T09:55:22Z",
      "side": 1,
      "message": "we\u0027ll remove bootdevice and add because there is no requirement of \"a single bootdevice\".\n\n/dev/block/platform/by-name/system for non-A/B device\n\nand \n\n/dev/block/platform/by-name/system_a\n/dev/block/platform/by-name/system_b\n\nfor A/B devices.\n\nNote that uevent.partition_name will contain _a or _b on A/B devices.",
      "range": {
        "startLine": 19,
        "startChar": 54,
        "endLine": 19,
        "endChar": 64
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d597c93_308ac42c",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 348,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-02T09:53:43Z",
      "side": 1,
      "message": "this is a weird assumption, why need to have \"_a\" for non-A/B device?",
      "range": {
        "startLine": 348,
        "startChar": 15,
        "endLine": 348,
        "endChar": 77
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0310e2d_3508f563",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 348,
      "author": {
        "id": 1315132
      },
      "writtenOn": "2018-05-02T11:33:32Z",
      "side": 1,
      "message": "For A/B devices, some partition suffix is \"_a\" or \"_b\", but some partiton has no _a/_b suffix, like \"userdata\". So, the device, for \"userdata\", we directly links to bootdevice/by-name/userdata.\nAnd ab_suffix value is from fs_mgr_get_boot_config, which get the value from cmdline, property or device-tree, further more it tells us that the system is boot from _a partition or _b partition. So, if boot from _a partition, we only links the _a partition to bootdevice/by-name/... and _b partition will be passed",
      "parentUuid": "2d597c93_308ac42c",
      "range": {
        "startLine": 348,
        "startChar": 15,
        "endLine": 348,
        "endChar": 77
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f8d94b9f_79a2d52f",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 348,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-03T02:52:07Z",
      "side": 1,
      "message": "OK, I see. I must have misunderstood the statement here.\nThanks for the detailed explanation.",
      "parentUuid": "f0310e2d_3508f563",
      "range": {
        "startLine": 348,
        "startChar": 15,
        "endLine": 348,
        "endChar": 77
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b76560b_fdf996b9",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 359,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-02T09:53:43Z",
      "side": 1,
      "message": "why ab_suffix need to be trimmed?",
      "range": {
        "startLine": 359,
        "startChar": 20,
        "endLine": 359,
        "endChar": 94
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67a8268d_584ebae4",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 359,
      "author": {
        "id": 1315132
      },
      "writtenOn": "2018-05-02T11:33:32Z",
      "side": 1,
      "message": "bootdevice only links to the partition which the system boot from, I think!",
      "parentUuid": "2b76560b_fdf996b9",
      "range": {
        "startLine": 359,
        "startChar": 20,
        "endLine": 359,
        "endChar": 94
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "14d717a9_f03a18cf",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 359,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-03T02:52:07Z",
      "side": 1,
      "message": "Got your idea and also discussed with the owner.\n\nSeems everyone forgets there is \u0027slotselect\u0027 in fstab :)\nIt will smartly append ab_suffix for you. So during uevent processing for symlink, it\u0027s ok to always keep the ab_suffix. \n\nIn sum, two approaches to deal with A/B:\n  1. fs_mgr appends ab_suffix to each A/B partitions in the fstab (via slotselect). And keep ab_suffix when creating symlinks.\n\n  2. Remove ab_suffix during uevent processing, and creates no-ab_suffix symlinks for fstab to use.\n\nI was thinking about 1. so didn\u0027t get that you\u0027re doing 2 (sorry!).",
      "parentUuid": "67a8268d_584ebae4",
      "range": {
        "startLine": 359,
        "startChar": 20,
        "endLine": 359,
        "endChar": 94
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "25ba14fb_3ac96470",
        "filename": "init/devices.cpp",
        "patchSetId": 2
      },
      "lineNbr": 369,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-02T09:53:43Z",
      "side": 1,
      "message": "This part looks too complicated.\n\nWe\u0027ll add a proper fix in:\nhttps://android-review.googlesource.com/#/c/platform/system/core/+/674989/\n\nPlease comment there.",
      "range": {
        "startLine": 356,
        "startChar": 10,
        "endLine": 369,
        "endChar": 13
      },
      "revId": "02e263b8d31b3d4a4927379d0040e3b5c302e050",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}