{
  "comments": [
    {
      "key": {
        "uuid": "cdd33652_b6d7a69a",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 433,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2017-11-09T22:35:46Z",
      "side": 1,
      "message": "actually, this needs to be 01750\n\nYou\u0027re setting SGID, not the GID sticky bit.\n\nSee:\nhttps://www.thegeekdiary.com/what-is-suid-sgid-and-sticky-bit/",
      "range": {
        "startLine": 433,
        "startChar": 39,
        "endLine": 433,
        "endChar": 44
      },
      "revId": "74fa3cab4eb564678d3cdeefdd18da2504948b74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "40a2faf2_54453e1a",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 433,
      "author": {
        "id": 1088085
      },
      "writtenOn": "2017-11-09T23:04:56Z",
      "side": 1,
      "message": "wait, I thought we need the sgid so that the file created could inherit the directory\u0027s \u0027log\u0027 gid? Otherwise the file will have the ids \u0027root root\u0027; and inaccessible to log groups since it has the permission 0640. The file won\u0027t be deleted by other users anyway since they don\u0027t have the write permission.",
      "parentUuid": "cdd33652_b6d7a69a",
      "range": {
        "startLine": 433,
        "startChar": 39,
        "endLine": 433,
        "endChar": 44
      },
      "revId": "74fa3cab4eb564678d3cdeefdd18da2504948b74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d92c83b_e39bb973",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 433,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2017-11-10T05:05:16Z",
      "side": 1,
      "message": "That\u0027s not what SGID does. SGID does something similar, but different. See the link that I provided above which describes both SGID and the GID sticky bit.",
      "parentUuid": "40a2faf2_54453e1a",
      "range": {
        "startLine": 433,
        "startChar": 39,
        "endLine": 433,
        "endChar": 44
      },
      "revId": "74fa3cab4eb564678d3cdeefdd18da2504948b74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2851c3df_8c78622d",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 433,
      "author": {
        "id": 1088085
      },
      "writtenOn": "2017-11-10T07:13:23Z",
      "side": 1,
      "message": "hmm... I did some test in the shell and the GID sticky bit only doesn\u0027t seem to work.\n\nchmod 1750 /data/misc/update_engine_log/ \ndrwxr-x--T 2 root log 4096 2009-01-01 23:46 /data/misc/update_engine_log/\n\ntouch /data/misc/update_engine_log/test_file\nchmod 0640 /data/misc/update_engine_log/test_file\n-rw-r-----  1 root   root     0 2009-01-02 08:09 test_file\n\nsu 1007 (switch to log uid)\nls -al /data/misc/update_engine_log\ndrwxr-x--T  2 root   log   4096 2009-01-02 08:09 .\ndrwxrwx--t 52 system misc  4096 2009-01-01 03:18 ..\n-rw-r-----  1 root   root     0 2009-01-02 08:09 test_file\n\ncat /data/misc/update_engine_log/test_file\ncat: /data/misc/update_engine_log/test_file: Permission denied\n\nLooks like the sticky bit only make sense if we have 777 on file permission?",
      "parentUuid": "9d92c83b_e39bb973",
      "range": {
        "startLine": 433,
        "startChar": 39,
        "endLine": 433,
        "endChar": 44
      },
      "revId": "74fa3cab4eb564678d3cdeefdd18da2504948b74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "01752733_23f7c95c",
        "filename": "rootdir/init.rc",
        "patchSetId": 2
      },
      "lineNbr": 433,
      "author": {
        "id": 1246512
      },
      "writtenOn": "2017-11-10T15:06:35Z",
      "side": 1,
      "message": "I think the man page of chmod provides a more clear explanation of sticky bit (alias restricted deletion flag):\nhttp://man7.org/linux/man-pages/man1/chmod.1.html\n\n\nI have performed local testing using:\n\n  mkdir /data/misc/update_engine_log 02750 root log\n\nDirectory and log files are created as:\n\n  # ls -la /data/misc/update_engine_log/\n  total 12\n  drwxr-s---  2 root   log  4096 2017-11-10 06:28 .\n  drwxrwx--t 42 system misc 4096 1970-01-02 18:24 ..\n  -rw-r-----  1 root   log   209 2017-11-10 06:28 update_engine.log\n\n\nTest was performed with update engine not being part of log group (comment in https://android-review.googlesource.com/#/c/platform/system/update_engine/+/529081/3/update_engine.rc)",
      "parentUuid": "2851c3df_8c78622d",
      "range": {
        "startLine": 433,
        "startChar": 39,
        "endLine": 433,
        "endChar": 44
      },
      "revId": "74fa3cab4eb564678d3cdeefdd18da2504948b74",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}