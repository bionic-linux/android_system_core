{
  "comments": [
    {
      "key": {
        "uuid": "f94bcf71_81b40dd8",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 193,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2014-03-31T18:00:59Z",
      "side": 1,
      "message": "I don\u0027t think we should be suggesting this, even for debugging.  The shell already has to be running as root, so logd should be able to write to /dev/socket as is.",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3929e785_e28e2ed7",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 193,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2014-03-31T18:29:45Z",
      "side": 1,
      "message": "No choice, logd reduces itself to AID_LOGD and can no longer add sockets to /dev/socket.",
      "parentUuid": "f94bcf71_81b40dd8",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9a02f5c_1c8175a2",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 197,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2014-03-31T18:00:59Z",
      "side": 1,
      "message": "logd should be able to do this itself if it created the socket",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5944db56_1e52b12c",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 197,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2014-03-31T18:29:45Z",
      "side": 1,
      "message": "By the time the threads are started, too late ...",
      "parentUuid": "f9a02f5c_1c8175a2",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9a02f5c_9c16e5a4",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 198,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2014-03-31T18:00:59Z",
      "side": 1,
      "message": "if its 755, why do you care what the owner/group is?",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1926e3b5_d6c41a52",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 198,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2014-03-31T18:29:45Z",
      "side": 1,
      "message": "the sockets themselves are not created 755 ...",
      "parentUuid": "f9a02f5c_9c16e5a4",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9a02f5c_dcceadf8",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 200,
      "author": {
        "id": 1002751
      },
      "writtenOn": "2014-03-31T18:00:59Z",
      "side": 1,
      "message": "why are you bothering re-enabling selinux?  I would expect this mostly to be used to run gdb or valgrind on logd, and you probably won\u0027t care about selinux.",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5944db56_de43095f",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 200,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2014-03-31T18:29:45Z",
      "side": 1,
      "message": "Because one should, pedantically, require everything to be \u0027normal\u0027 when testing. The developer can choose to ignore this line.",
      "parentUuid": "f9a02f5c_dcceadf8",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b9d157e4_75746256",
        "filename": "logd/LogReader.cpp",
        "patchSetId": 3
      },
      "lineNbr": 200,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2014-03-31T21:33:45Z",
      "side": 1,
      "message": "Inspected regarding the dropping/annealing of privileges, and SCHED_BATCH, CAP_SYSLOG and PR_SET_KEEPCAPS had no equivalent in init. I could however, drop the setuid/setgid calls in favor of adjustments in init.rc.\n\nvalgrind usage is full of problems itself though ...\n1) turn off error checking in drop_privs in logd/main.cpp because of unknown system call warnings.\n2) Other unknown system calls breaking selinux auditd code\n3) /system/lib64/memcheck-arm64-linux is 644 and should be 755 when installed.\n\nWe have to disable logd startup as well in order to \u0027break in\u0027\n\nAfter workaround, minimal valgrind shell commands for startup:\n1) setenforce 0\n2) chmod 777 /dev/socket (if we do not drop setuid/setgid)\n3) valgrind /system/bin/logd\n\nThe provided script is to represent the pedantic startup so that all security systems are running normally, and was meant as living proof that we could start up logd in the proper context.",
      "parentUuid": "5944db56_de43095f",
      "revId": "bed55839655866b93e7f1b08d5705214b096da36",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}