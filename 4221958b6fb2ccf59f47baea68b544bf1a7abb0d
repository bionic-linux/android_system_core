{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "a23dad63_cb534634",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:55:54Z",
      "side": 1,
      "message": "(various nits, though i\u0027m still not entirely convinced that this warrants being an API...)",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9955a9e_5dfb817f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:57:34Z",
      "side": 1,
      "message": "(specifically: you have one user right now. typically we want to see three unrelated users [in different projects] before we start to think about adding an API. also: tests!)",
      "parentUuid": "a23dad63_cb534634",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "90953094_7253b50c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1965080
      },
      "writtenOn": "2022-11-30T00:25:38Z",
      "side": 1,
      "message": "I\u0027m not tied to this being an API - conceptually, it made sense to me that this bit of code would live in ashmem-dev.cpp, so that\u0027s where I put it. That said, it also makes sense to me that making it an API may increase our maintenance burden (even if slightly). Let me know if you want it moved and I\u0027m happy to do so.\n\nTests-wise I\u0027m thinking to add a test to ashmem-test.cpp which verifies that two distinct fds to the same region return the same inode number. Does that sound reasonable? For the test, keeping this as an API would probably reduce code duplication.",
      "parentUuid": "e9955a9e_5dfb817f",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "433068dc_d2d04e05",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-30T00:36:49Z",
      "side": 1,
      "message": "yeah, i think as long as you only have one caller (and i\u0027m honestly really struggling to imagine another), just inline it into that one caller? (that also gives you the freedom to fix the API if/when you do move it out.)",
      "parentUuid": "90953094_7253b50c",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5490b0ee_c87472cd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1965080
      },
      "writtenOn": "2022-11-30T00:39:51Z",
      "side": 1,
      "message": "Sure. I\u0027ll upload an updated set of patches once I have that going.",
      "parentUuid": "433068dc_d2d04e05",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "615707ed_8031e258",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1965080
      },
      "writtenOn": "2022-11-30T00:58:43Z",
      "side": 1,
      "message": "Hmm, if I want to keep the ability to seamlessly handled memfd vs ashmem while also inlining this function at it\u0027s call sites, I\u0027d need to export has_memfd_support() and memfd_is_ashmem(). Are we ok with that?",
      "parentUuid": "5490b0ee_c87472cd",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "acb63ba6_cd46bbbc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-30T01:02:28Z",
      "side": 1,
      "message": "are we actually ever going to do the memfd thing? it\u0027s been enough years now that i\u0027m getting really skeptical. (and no-one\u0027s actually signed up for that work, right, so it\u0027s not _likely_ to happen either?)\n\ntbh, i don\u0027t think it would be much of a regression for you to merge the ashmem-only code and just throw this on the existing pile of \"stuff we\u0027d need to fix to be able to switch to memfd\" :-(\n\n(i\u0027d love to be wrong though, in which case, yes, let\u0027s expose those functions!)",
      "parentUuid": "615707ed_8031e258",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "595132a9_f168bafd",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 5
      },
      "lineNbr": 478,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:55:54Z",
      "side": 1,
      "message": "inode\n\nshould we include a device too? given that there are multiple possibilities?",
      "range": {
        "startLine": 478,
        "startChar": 4,
        "endLine": 478,
        "endChar": 26
      },
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e8f29a9a_5c434640",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 5
      },
      "lineNbr": 479,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:55:54Z",
      "side": 1,
      "message": "don\u0027t declare until you can initialize.",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3808d0d_b8c5f340",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 5
      },
      "lineNbr": 480,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:55:54Z",
      "side": 1,
      "message": "return early and set errno to EINVAL.",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64d1b0c0_8e686245",
        "filename": "libcutils/ashmem-dev.cpp",
        "patchSetId": 5
      },
      "lineNbr": 486,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2022-11-29T22:55:54Z",
      "side": 1,
      "message": "the other functions seem to return -1 and set errno?",
      "revId": "4221958b6fb2ccf59f47baea68b544bf1a7abb0d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}