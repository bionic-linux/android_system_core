{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "4d319947_7870ce4d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-09-18T19:40:55Z",
      "side": 1,
      "message": "I have another question for you:\n\nI don\u0027t want to make netd \u0027reboot_on_failure\u0027 because as a daemon it could fail and restart during serving, but *certain* types of early init failures should just trigger a reboot (for example bpf or dnsresolver init failures, since that comes from the mainline tethering/dnsresolver apexes).  I\u0027m considering getting netd to do \u0027echo b \u003e /proc/sysrq-trigger\u0027 if the init phase fails - thus triggering a reboot and likely mainline module rollback.  Any better ideas?",
      "revId": "3c50b920abca2d5522d0a7ddcf0c172b474518b2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "654ef4e0_7959ab62",
        "filename": "rootdir/init.rc",
        "patchSetId": 4
      },
      "lineNbr": 563,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-19T02:24:45Z",
      "side": 1,
      "message": "I think this change is good (are you sure it will work? netd doesn\u0027t rely on anything early? tested enough?)\n\nbut should we add \u0027post-bpf\u0027? so it\u0027s symmetrical?",
      "range": {
        "startLine": 562,
        "startChar": 0,
        "endLine": 563,
        "endChar": 14
      },
      "revId": "3c50b920abca2d5522d0a7ddcf0c172b474518b2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a81cacb9_1e220f23",
        "filename": "rootdir/init.rc",
        "patchSetId": 4
      },
      "lineNbr": 563,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-09-19T19:05:00Z",
      "side": 1,
      "message": "well it works in local testing, cuttlefish and TreeHugger, and I can\u0027t think of any reason it wouldn\u0027t work...\n\nMy understanding is once we run \u0027start netd\u0027 once, even if netd crashes (which can happen in response to system server crashes for example) it\u0027ll get restarted by init...\n\nBy \u0027post-bpf\u0027 do you mean to add a trigger?\n\nie.\ntrigger load_bpf_programs\ntrigger bpf-progs-loaded\n\non bpf-progs-loaded\n  start netd",
      "parentUuid": "654ef4e0_7959ab62",
      "range": {
        "startLine": 562,
        "startChar": 0,
        "endLine": 563,
        "endChar": 14
      },
      "revId": "3c50b920abca2d5522d0a7ddcf0c172b474518b2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}