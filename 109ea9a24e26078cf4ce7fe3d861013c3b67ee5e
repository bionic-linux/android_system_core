{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "612d94eb_93c1e500",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 235,
      "author": {
        "id": 1964171
      },
      "writtenOn": "2024-11-20T20:49:16Z",
      "side": 1,
      "message": "should this be inside the scoped braces?",
      "fixSuggestions": [
        {
          "fixId": "eca0ccaa_83823f61",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
              "range": {
                "startLine": 235,
                "startChar": 0,
                "endLine": 236,
                "endChar": 0
              },
              "replacement": ""
            },
            {
              "path": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
              "range": {
                "startLine": 237,
                "startChar": 0,
                "endLine": 237,
                "endChar": 0
              },
              "replacement": "            std::lock_guard\u003cstd::mutex\u003e buffer_lock(snapuserd_-\u003eGetBufferLock());\n"
            }
          ]
        }
      ],
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "98feaf1f_1abe4ba4",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 235,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2024-11-20T21:16:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "612d94eb_93c1e500",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7631f952_c1025505",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 237,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-11-20T20:44:01Z",
      "side": 1,
      "message": "We\u0027re now at 8 indent levels in some parts of this function. Can it be factored out into a helper?\n\nOr, do something like this:\n\n```\nstd::optional\u003cstd::lock_guard\u003cstd::mutex\u003e\u003e buffer_lock;\n\nbuffer_lock.emplace(snapuserd_-\u003eGetBufferLock());\n\n... code ... \n\nbuffer_lock \u003d {};\n```",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1723d1f2_9add592c",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 237,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2024-11-20T21:16:01Z",
      "side": 1,
      "message": "Nice. thanks",
      "parentUuid": "7631f952_c1025505",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40f63dc6_a6a125f1",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 424,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-11-20T20:44:01Z",
      "side": 1,
      "message": "Are braces needed here? The lock is scoped outside them.",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "62f1eb77_ad9161a4",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/merge_worker.cpp",
        "patchSetId": 2
      },
      "lineNbr": 424,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2024-11-20T21:16:01Z",
      "side": 1,
      "message": "Yes - lock should be inside. My bad.\n\nBraces just improves readability to highlight that the lock is for the buffer. We can technically hold the lock until the end of this function.",
      "parentUuid": "40f63dc6_a6a125f1",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "331ac3c4_3df3ce81",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/snapuserd_readahead.cpp",
        "patchSetId": 2
      },
      "lineNbr": 709,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-11-20T20:49:51Z",
      "side": 1,
      "message": "Same here, the lock outlives the call to ReadAheadIOCompleted",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "79402274_3116b161",
        "filename": "fs_mgr/libsnapshot/snapuserd/user-space-merge/snapuserd_readahead.cpp",
        "patchSetId": 2
      },
      "lineNbr": 709,
      "author": {
        "id": 1724998
      },
      "writtenOn": "2024-11-20T21:16:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "331ac3c4_3df3ce81",
      "revId": "109ea9a24e26078cf4ce7fe3d861013c3b67ee5e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}