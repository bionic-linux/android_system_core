{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "2ebe6444_b3820834",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2147,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-03-20T15:59:22Z",
      "side": 1,
      "message": "Can we clarify the \"interaction\" comment? update_engine will use the system snapuserd for installing new updates (which is safe since the on-disk format is the same). It will use the legacy path when communicating with vendor snapuserd that was started in first-stage init.",
      "revId": "f0e2fe047c76b07cb215a6e72a354f45995ee7f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f454291a_fbf251c3",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2173,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-03-20T15:59:22Z",
      "side": 1,
      "message": "This can get called before is_legacy_snapuserd_ is set. I think it works because we\u0027ll fall through to UpdateUsersUserSnapshots, but I think it\u0027d be good to either clarify that or remove the call. Or, move it inside the \"if\" below.",
      "revId": "f0e2fe047c76b07cb215a6e72a354f45995ee7f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40afa0d4_bc18d7ec",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 5
      },
      "lineNbr": 2190,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-03-20T15:59:22Z",
      "side": 1,
      "message": "Rather than call this twice, I think we could re-order the code:\n\n    if (!is_snapshot_userspace_.has_value()) {\n        SnapshotUpdateStatus update_status \u003d ReadSnapshotUpdateStatus(lock);\n        is_snapshot_userspace_ \u003d update_status.userspace_snapshots();\n        is_legacy_snapuserd_ \u003d update_status.legacy_snapuserd();\n    }\n\n    if (IsLegacySnapuserdPostReboot()) {\n        return false;\n    }\n\n    return is_snapshot_userspace_.value();",
      "revId": "f0e2fe047c76b07cb215a6e72a354f45995ee7f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21a55e5d_e6a9935e",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 5
      },
      "lineNbr": 3269,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2024-03-20T15:59:22Z",
      "side": 1,
      "message": "naming convention nit: \"is_legacy_snapuserd\"",
      "revId": "f0e2fe047c76b07cb215a6e72a354f45995ee7f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}