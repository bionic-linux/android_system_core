{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f5622e0d_7e25b7ca",
        "filename": "libstats/socket_lazy/libstatssocket_lazy.cpp",
        "patchSetId": 3
      },
      "lineNbr": 84,
      "author": {
        "id": 1827146
      },
      "writtenOn": "2024-05-14T17:30:48Z",
      "side": 1,
      "message": "nit: is there reference client code which uses this API?\n\nI would like to double check below use case:\n\nSince the local static variable initialized only once - the very first time the API is called, if the libstatssocket.so is not ready - the initial value will be NULL\nand each consecutive call will not try to update this value/will and try to load library again\n\nhttps://en.cppreference.com/w/cpp/language/storage_duration#Static_local_variables\n\n```\nVariables declared at block scope with the specifier static ... are initialized the first time control passes through their declaration. On all further calls, the declaration is skipped.\n```\n\nwill it make consecutive calls to `IsAvailable` no op if very first call was too early?\n\nThank you",
      "fixSuggestions": [
        {
          "fixId": "27523b59_58776120",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "libstats/socket_lazy/libstatssocket_lazy.cpp",
              "range": {
                "startLine": 84,
                "startChar": 0,
                "endLine": 86,
                "endChar": 0
              },
              "replacement": "    return LoadLibstatssocket(RTLD_NOW) !\u003d nullptr;\n"
            }
          ]
        }
      ],
      "revId": "1f98e718909dbb9c2cdf7d032552b9f51552517a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e82985bc_0e6c8bef",
        "filename": "libstats/socket_lazy/libstatssocket_lazy.cpp",
        "patchSetId": 3
      },
      "lineNbr": 84,
      "author": {
        "id": 1415877
      },
      "writtenOn": "2024-05-15T01:54:19Z",
      "side": 1,
      "message": "\u003e nit: is there reference client code which uses this API?\n\nYes, see aosp/3081209.\n\n\u003e will it make consecutive calls to IsAvailable no op if very first call was too early?\n\nYes, that\u0027s my intention. I don\u0027t think there\u0027s a case where libstatssocket.so **becomes** available after opening it once failed. So, when it\u0027s unavailable, the API returns false always. When it\u0027s not, the API returns true always without increasing the library again and again.",
      "parentUuid": "f5622e0d_7e25b7ca",
      "revId": "1f98e718909dbb9c2cdf7d032552b9f51552517a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "494eb066_b83ff42f",
        "filename": "libstats/socket_lazy/libstatssocket_lazy.cpp",
        "patchSetId": 3
      },
      "lineNbr": 84,
      "author": {
        "id": 1827146
      },
      "writtenOn": "2024-05-15T01:57:10Z",
      "side": 1,
      "message": "nit: const",
      "parentUuid": "e82985bc_0e6c8bef",
      "revId": "1f98e718909dbb9c2cdf7d032552b9f51552517a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}