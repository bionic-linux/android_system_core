{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "ab582b32_e3191732",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2023-09-13T04:58:14Z",
      "side": 1,
      "message": "We can\u0027t change the header without a version bump - this will break downgrade OTAs. The problem is writer_v2 will be writing sizeof(CowHeader) bytes, which is now changing, and older versions of CowParserV2 won\u0027t know to how to read it.\n\nThere are two ways to deal with this.\n\n(1) Hardcode the existing sizeof(CowHeader) somewhere. Eg, if it\u0027s 80 bytes, have:\n\n     static constexpr size_t kCowHeaderV2Size \u003d 80;\n \nAnd replace uses of sizeof(CowHeader) in parser_v2/writer_v2. Or,\n\n(2) Create a CowHeaderV2, identical to the current CowHeader, and replace uses in the parser/writer. Then convert from CowHeaderV2 -\u003e CowHeader in CowReader.\n\n(3) We could also have CowHeader inherit from a CowHeaderV2, but you\u0027d still need the refactoring from (2).",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5ecbbc52_fc8f7e8f",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1964171
      },
      "writtenOn": "2023-09-19T05:25:28Z",
      "side": 1,
      "message": "I\u0027m going to go with hard coding the cow size for v2 writer, gonna add it to some documentation and think if there\u0027s any case where it would be a problem",
      "parentUuid": "ab582b32_e3191732",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f7f316cd_c5bac01b",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2023-09-19T16:43:57Z",
      "side": 1,
      "message": "Can we follow what boot image header did?\n\nhttps://source.corp.google.com/h/googleplex-android/platform/superproject/main/+/main:system/tools/mkbootimg/include/bootimg/bootimg.h;l\u003d156;drc\u003dc257c4a69cc4abdca6b62a3f8f447513d396d741\n\nIt uses inheritance to create different types for different version of headers. I would rather not hard code any magic values if possible.",
      "parentUuid": "5ecbbc52_fc8f7e8f",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "193df013_f166ea18",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1964171
      },
      "writtenOn": "2023-10-10T18:14:21Z",
      "side": 1,
      "message": "okay, I like this idea, should we also do this for cowOperationV3 as in it just inherits from cowOperationV2? Are there any technical limitations as why we can\u0027t do this?",
      "parentUuid": "f7f316cd_c5bac01b",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c06a5aa5_c7afb519",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2023-10-10T18:17:43Z",
      "side": 1,
      "message": "CowOperationV3 can\u0027t inherit from V2, it\u0027s a whole new struct. Otherwise it\u0027d work fine.",
      "parentUuid": "193df013_f166ea18",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "34fdeb29_7ef150da",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/cow_format.h",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1964171
      },
      "writtenOn": "2023-10-10T18:18:47Z",
      "side": 1,
      "message": "that comment was from a while ago, forgot discard it haha",
      "parentUuid": "c06a5aa5_c7afb519",
      "revId": "dee3423b5f6a3aefba71be63a97c02e505234be0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}