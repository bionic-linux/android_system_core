{
  "comments": [
    {
      "key": {
        "uuid": "aaf900eb_92b8332d",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/snapshot.h",
        "patchSetId": 4
      },
      "lineNbr": 223,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "Since this is now being instantiated outside of Read/WriteSnapshotStatus, let\u0027s default-initialize everything to 0 (and maybe add a \"None\" or \"Invalid\" state), just so there\u0027s no uninitialized values floating around.",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c222d3b_f8932465",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/snapshot.h",
        "patchSetId": 4
      },
      "lineNbr": 223,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-04T23:55:50Z",
      "side": 1,
      "message": "+1, will do",
      "parentUuid": "aaf900eb_92b8332d",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55d0dbfe_cab5de74",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/snapshot.h",
        "patchSetId": 4
      },
      "lineNbr": 223,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-05T01:45:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1c222d3b_f8932465",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b2fd507b_4c266b72",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/snapshot.h",
        "patchSetId": 4
      },
      "lineNbr": 251,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "Once the tests are no longer dependent on this function, it\u0027d be nice to have CreateSnapshot take a |SnapshotStatus*|, so then the resulting status can be passed directly to CreateCowImage.",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f7e1488_31e5283e",
        "filename": "fs_mgr/libsnapshot/include/libsnapshot/snapshot.h",
        "patchSetId": 4
      },
      "lineNbr": 251,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-05T01:45:55Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b2fd507b_4c266b72",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c329de7b_ef5b43a4",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 104,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "If this is no longer used, can we remove it?",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2de01ff9_c1b43dbb",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 104,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-04T23:55:50Z",
      "side": 1,
      "message": "I am going to use it soon:\nhttps://android-review.googlesource.com/c/platform/system/core/+/1109106/2/fs_mgr/libsnapshot/snapshot.cpp#107",
      "parentUuid": "c329de7b_ef5b43a4",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "45ddfaf3_cc1707a4",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 104,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-05T00:10:53Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2de01ff9_c1b43dbb",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ba2cd4f1_aa1938c1",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 902,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "I think this should be moved above DeleteSnapshot, otherwise if it fails, the next reboot won\u0027t find the snapshot, and the COW image won\u0027t be cleaned up until the next OTA. (Maybe add a comment that DeleteSnapshot should be the last call in the function?)\n\nOr actually: why don\u0027t we delete the cow as part of deleting the snapshot? I know this would be asymmetrical, but it makes cleanup safer.",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a41a602e_a8b1448e",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 902,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-04T23:55:50Z",
      "side": 1,
      "message": "Hmm, you are right. So if the COW image goes away but the snapshot status file is still there, I guess it is okay (because it stores \"MergeCompleted\", which indicates that the COW image won\u0027t be mapped)?\n\nAlso, the reason I split it is symmetry indeed... they will become internal functions anyways.",
      "parentUuid": "ba2cd4f1_aa1938c1",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "be942681_a875a37c",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 902,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-05T00:10:53Z",
      "side": 1,
      "message": "I\u0027d argue it\u0027s kind of a self-defeating symmetry. It\u0027s useful to ad-hoc tie dependencies together, but also clean them up as one unit. I\u0027d be in favor of that here, especially since we don\u0027t want to step-by-step cleanup in each place that does cleanup.",
      "parentUuid": "a41a602e_a8b1448e",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "46be5dcd_98a612f1",
        "filename": "fs_mgr/libsnapshot/snapshot.cpp",
        "patchSetId": 4
      },
      "lineNbr": 902,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-05T01:45:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "be942681_a875a37c",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ca4caef3_bab806cb",
        "filename": "fs_mgr/libsnapshot/snapshot_test.cpp",
        "patchSetId": 4
      },
      "lineNbr": 441,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "Why isn\u0027t the image unmapped at this point?",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ecd7affe_24577539",
        "filename": "fs_mgr/libsnapshot/snapshot_test.cpp",
        "patchSetId": 4
      },
      "lineNbr": 441,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-04T23:55:50Z",
      "side": 1,
      "message": "DeleteSnapshotDevice deletes the device on device mapper, but not unset the property. GSID still thinks the image is mapped, and L445 will fail because it thinks it is already mapped.\n\nAlso, the test fails for me even without this CL.",
      "parentUuid": "ca4caef3_bab806cb",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba9b2b91_922e5efc",
        "filename": "fs_mgr/libsnapshot/snapshot_test.cpp",
        "patchSetId": 4
      },
      "lineNbr": 441,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-05T00:10:53Z",
      "side": 1,
      "message": "Interesting, I haven\u0027t hit that failure yet. Is there some kind of race? Is DeleteSnapshotDevice not unmapping the cow? (It must be unmapped since we try to map it again below.)",
      "parentUuid": "ecd7affe_24577539",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a2e56d84_c601775f",
        "filename": "fs_mgr/libsnapshot/snapshot_test.cpp",
        "patchSetId": 4
      },
      "lineNbr": 441,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-05T01:45:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ba9b2b91_922e5efc",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d7a67a64_f1591ba6",
        "filename": "fs_mgr/libsnapshot/utility.cpp",
        "patchSetId": 4
      },
      "lineNbr": 22,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2019-09-04T23:38:23Z",
      "side": 1,
      "message": "Let\u0027s add this as a helper function to IImageManager, it seems useful.",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "11bc79ce_5d49416a",
        "filename": "fs_mgr/libsnapshot/utility.cpp",
        "patchSetId": 4
      },
      "lineNbr": 22,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2019-09-05T01:45:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d7a67a64_f1591ba6",
      "revId": "fd02f4bfeeb05db2b3184720cb5697aa74809198",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}