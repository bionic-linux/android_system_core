{
  "comments": [
    {
      "key": {
        "uuid": "10dbe6c4_9cc09d7f",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1066743
      },
      "writtenOn": "2018-07-31T16:37:05Z",
      "side": 1,
      "message": "Can this incorporate some time concept into the variable name? What about |reconnect_timestamp|? Or just |timestamp|.",
      "range": {
        "startLine": 105,
        "startChar": 46,
        "endLine": 105,
        "endChar": 58
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2fdff9f3_2834b330",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 105,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2018-07-31T22:30:22Z",
      "side": 1,
      "message": "used reconnect_timestamp, since timestamp kinda implies to me that it was the timestamp that we enqueued the attempt",
      "parentUuid": "10dbe6c4_9cc09d7f",
      "range": {
        "startLine": 105,
        "startChar": 46,
        "endLine": 105,
        "endChar": 58
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "73f09a24_772114e0",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 151,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-07-31T02:35:37Z",
      "side": 1,
      "message": "I\u0027m new to this code, so I could be wrong, but: So before, the ReconnectAttempt would have a deadline 10 sec in the future, so it would call wait_until(10 sec) and could potentially wait 10 sec. But now this sets ReconnectAttempt to have a next_attempt of right now, so it would call wait_until(now) which would presumably return right away and then try to reconnect right away? Or maybe I\u0027m misunderstanding?",
      "range": {
        "startLine": 151,
        "startChar": 61,
        "endLine": 151,
        "endChar": 93
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "313fc26f_6cbc484d",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 151,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2018-07-31T08:25:57Z",
      "side": 1,
      "message": "Correct, this was an intentional change that probably should be split off into a separate commit. My reasoning is that it probably doesn\u0027t make much sense to wait 10 seconds before trying to reconnect: the common cases for a disconnection are things along the lines of `adb root`, `adb shell killall adbd`, adbd crashing, where we want to reconnect immediately, and the network being interrupted, in which case we\u0027re probably not going to find out that the socket is dead until way later anyway.",
      "parentUuid": "73f09a24_772114e0",
      "range": {
        "startLine": 151,
        "startChar": 61,
        "endLine": 151,
        "endChar": 93
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51a3ea7a_2b76a3d6",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 151,
      "author": {
        "id": 1066743
      },
      "writtenOn": "2018-07-31T16:37:05Z",
      "side": 1,
      "message": "oh that\u0027s a good point. in Android-on-Chrome OS the typical case is that the container dies and it normally takes a few seconds to restart, so I was looking at this with container-tinted glasses.\n\nthis change makes sense, although maybe add a comment here that this will attempt to reconnect immediately, but will wait on future reconnection attempts.\n\nAlthough previously since all the attempts were added in monotonic order, a queue sufficed since they would end up being sorted. this time around, some entries will be added without the timeout bias, so the entries are not going to be sorted. so can you change |reconnect_queue_| to be a std::priority_queue?",
      "parentUuid": "313fc26f_6cbc484d",
      "range": {
        "startLine": 151,
        "startChar": 61,
        "endLine": 151,
        "endChar": 93
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6842a46_9a3e64b1",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 151,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-07-31T19:10:51Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "51a3ea7a_2b76a3d6",
      "range": {
        "startLine": 151,
        "startChar": 61,
        "endLine": 151,
        "endChar": 93
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "06fec645_05547f82",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 151,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2018-07-31T22:30:22Z",
      "side": 1,
      "message": "Done (split off into its a separate patch)",
      "parentUuid": "d6842a46_9a3e64b1",
      "range": {
        "startLine": 151,
        "startChar": 61,
        "endLine": 151,
        "endChar": 93
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0dba8c88_3a1eee3b",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 178,
      "author": {
        "id": 1066743
      },
      "writtenOn": "2018-07-31T16:37:05Z",
      "side": 1,
      "message": "Something I missed doing in the previous change was add comments to the predicate. So can you add something along the lines of\n\n // Go back to sleep in case |reconnect_cv_| woke up spuriously and we still\n // have more time to wait for the current attempt.",
      "range": {
        "startLine": 178,
        "startChar": 16,
        "endLine": 178,
        "endChar": 59
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8db32757_14c1e6e3",
        "filename": "adb/transport.cpp",
        "patchSetId": 1
      },
      "lineNbr": 178,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2018-07-31T22:30:22Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0dba8c88_3a1eee3b",
      "range": {
        "startLine": 178,
        "startChar": 16,
        "endLine": 178,
        "endChar": 59
      },
      "revId": "7465a677ea1695f49ff3670765f289aea6cf0319",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}