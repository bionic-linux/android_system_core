{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "75412dc8_4d8f3b58",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-05-04T00:01:46Z",
      "side": 1,
      "message": "Android",
      "range": {
        "startLine": 9,
        "startChar": 9,
        "endLine": 9,
        "endChar": 17
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "27d5ed0b_a59fdd18",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-04T00:43:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "75412dc8_4d8f3b58",
      "range": {
        "startLine": 9,
        "startChar": 9,
        "endLine": 9,
        "endChar": 17
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d8850443_44a94a5e",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T22:11:44Z",
      "side": 1,
      "message": "it won\u0027t have permission to read this? did you check denials?",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "142e9c2a_91e0a20b",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T22:23:37Z",
      "side": 1,
      "message": "There are no denials in the logs when generating the tombstones with `atest debuggerd_test`.",
      "parentUuid": "d8850443_44a94a5e",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc996c19_f8a685f7",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T22:31:20Z",
      "side": 1,
      "message": "Also no denials when killing a process manually to generate the tombstone.\n\nThe test requires_root, and I needed root to kill the process.",
      "parentUuid": "142e9c2a_91e0a20b",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4a6b3c7a_5097b57a",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T22:57:23Z",
      "side": 1,
      "message": "Also added fatal log to the health service on boot with no root access and still no avc denial. Whatever is creating these tombstones([crash_dump64](https://source.android.com/docs/core/tests/debug#debuggerd)?) doesn\u0027t seem to need permission.",
      "parentUuid": "cc996c19_f8a685f7",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6245698f_468e265f",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T23:41:47Z",
      "side": 1,
      "message": "I think it\u0027s probably because of this rule:\n```\ndontaudit crash_dump property_type:file read;\n```\n\nYou should need:\n\n```\ngetprop(crash_dump, misctrl_prop)\n```\n\nand also need to include a `-crash_dump` in the associated neverallow.\n\nYou should be able to test on pgagnostic CF, or I can try as well, to make sure it can print \u0027true\u0027.",
      "parentUuid": "4a6b3c7a_5097b57a",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4abdf46_06b16947",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-05-04T00:01:46Z",
      "side": 1,
      "message": "we don\u0027t include properties in the tombstone --- they\u0027re all bug reports separately anyway.",
      "parentUuid": "6245698f_468e265f",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0994e4e6_9cdb1ea3",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-04T00:47:00Z",
      "side": 1,
      "message": "We don\u0027t always have bugreports, and this was requested explicitly.",
      "parentUuid": "a4abdf46_06b16947",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa3b3df2_3d81d37d",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-04T00:47:55Z",
      "side": 1,
      "message": "or do you mean crash_dump isn\u0027t safe to read it?",
      "parentUuid": "0994e4e6_9cdb1ea3",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f45a9264_6d34951f",
        "filename": "debuggerd/libdebuggerd/tombstone_proto.cpp",
        "patchSetId": 1
      },
      "lineNbr": 718,
      "author": {
        "id": 1019050
      },
      "writtenOn": "2024-05-06T22:17:00Z",
      "side": 1,
      "message": "I don\u0027t have a strong opinion on this, I think it should be okay to add this property reading if it really can\u0027t be found any other way. But we should really avoid adding too many.\n\nIt depends on how strong an aversion to this enh has, I don\u0027t remember any history that means we should avoid this. But enh might have a case that could be a problem.\n\nI wonder if there is any problem that could cause this to deadlock if the process is reading a property when it crashes.",
      "parentUuid": "aa3b3df2_3d81d37d",
      "range": {
        "startLine": 718,
        "startChar": 0,
        "endLine": 718,
        "endChar": 97
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c342cf56_5a81f3af",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 588,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T23:35:44Z",
      "side": 1,
      "message": "btw should this be:\n\n```\nif (tombstone.page_size() !\u003d 4096) { ... }\n```\n\nsame with the one below?\n\nidk if we want to expose this on 1,000,000,000s of devices if they are only 4096 mode.",
      "range": {
        "startLine": 588,
        "startChar": 0,
        "endLine": 588,
        "endChar": 52
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "77785007_4f304f36",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 588,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T23:43:47Z",
      "side": 1,
      "message": "There aren\u0027t any optional fields in [the proto](https://source.corp.google.com/h/googleplex-android/platform/superproject/main/+/main:system/core/debuggerd/proto/tombstone.proto) today, so I figured we might always the same data. We can make it optional.",
      "parentUuid": "c342cf56_5a81f3af",
      "range": {
        "startLine": 588,
        "startChar": 0,
        "endLine": 588,
        "endChar": 52
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b0ddd0c4_bd8f5229",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 588,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T23:49:12Z",
      "side": 1,
      "message": "It looks like we can\u0027t make the proto fields optional right now.\n\n```\nsystem/core/debuggerd/proto/tombstone.proto: is a proto3 file that contains optional fields, but code generator protoc-gen-javastream hasn\u0027t been updated to support optional fields in proto3. Please ask the owner of this code generator to support proto3 optional.--javastream_out\n```\n\nWe can choose not to print anything in the proto_to_text file though.",
      "parentUuid": "77785007_4f304f36",
      "range": {
        "startLine": 588,
        "startChar": 0,
        "endLine": 588,
        "endChar": 52
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1ca1263_c30645ba",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 588,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T23:57:34Z",
      "side": 1,
      "message": "The proto probably should always have the data, but we don\u0027t have to print it yeah. You might see what crash_dump peeps think, but I imagine when most devices are still 4KB, it might be more of a distraction.",
      "parentUuid": "b0ddd0c4_bd8f5229",
      "range": {
        "startLine": 588,
        "startChar": 0,
        "endLine": 588,
        "endChar": 52
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "12c78765_ff573c67",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 588,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-04T00:43:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c1ca1263_c30645ba",
      "range": {
        "startLine": 588,
        "startChar": 0,
        "endLine": 588,
        "endChar": 52
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81975262_62666249",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 589,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T23:36:06Z",
      "side": 1,
      "message": "like - only show this if it is true?",
      "range": {
        "startLine": 589,
        "startChar": 0,
        "endLine": 589,
        "endChar": 82
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac6e55ed_d6322d2d",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 589,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-03T23:43:47Z",
      "side": 1,
      "message": "Only show this particular line if it\u0027s true, or only show either of these fields if this is true?\n\nLike a natural 16k devices without switching to/from doesn\u0027t need this info?",
      "parentUuid": "81975262_62666249",
      "range": {
        "startLine": 589,
        "startChar": 0,
        "endLine": 589,
        "endChar": 82
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7d7f2919_0fb7e547",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 589,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-05-03T23:57:34Z",
      "side": 1,
      "message": "I think the best condition might be:\n\n```\nif (tombstone.has_been_16kb_mode() \u0026\u0026 tombstone.page_size() !\u003d 16384) {\n    CBL(\"Has been in 16kb mode: %s\", tombstone.has_been_16kb_mode() ? \"yes\" : \"no\");\n```\n\n(both conditions because 99.999% of the time it will be false, and also if the page size is 16K, this one should also be true)",
      "parentUuid": "ac6e55ed_d6322d2d",
      "range": {
        "startLine": 589,
        "startChar": 0,
        "endLine": 589,
        "endChar": 82
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b808ae3b_b1627903",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 589,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2024-05-04T00:01:46Z",
      "side": 1,
      "message": "yeah, +1 to not saying anything unless it\u0027s not 4096.",
      "parentUuid": "7d7f2919_0fb7e547",
      "range": {
        "startLine": 589,
        "startChar": 0,
        "endLine": 589,
        "endChar": 82
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7a2ad342_a14975d3",
        "filename": "debuggerd/libdebuggerd/tombstone_proto_to_text.cpp",
        "patchSetId": 1
      },
      "lineNbr": 589,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2024-05-04T00:43:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b808ae3b_b1627903",
      "range": {
        "startLine": 589,
        "startChar": 0,
        "endLine": 589,
        "endChar": 82
      },
      "revId": "e493c59595ed757b96e8d31e107cacb94de30b1b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}