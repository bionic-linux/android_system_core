{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b754b869_e3205d87",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2021-01-21T16:58:44Z",
      "side": 1,
      "message": "The purpose of -R is interface candy, it is meant to do what is necessary for the successful reboot all curled up into one flag. It is to disable verity, setup the foundation for a remount, and then reboot if necessary so that the next command will be wait-for-device then adb push of content.\n\nCan you incorporate a call to gsi-tool enable -s, or directly to the library functions open coded here if simple enough, rather than reporting an error and asking the caller to perform \u0027one more thing\u0027?",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "868aad87_dd7ff7d6",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2021-01-21T17:18:22Z",
      "side": 1,
      "message": "It\u0027s doable. I could just call `gsid-\u003eenableGsi(true)` here and DSU would be enabled for the next reboot.\n\nI did consider doing this when I\u0027m writing this, but I\u0027m a little worried that this may feel like \"trapping\" the user within the DSU system. Normally rebooting within DSU guest takes you back to the host system, and one has to deliberately call \"gsi_tool enable -s\" to make subsequent reboots stay within the guest system. This is like an insurance to keep the user from being \"trapped\" in DSU.\n\nBut I think one can also argue that since the user is already running a userdebug host system + userdebug guest system and playing with \"adb remount -R\", the user must really know what they\u0027re dealing with, and is well-informed of the danger of playing with fire ðŸ”¥ ðŸ˜Ž",
      "parentUuid": "b754b869_e3205d87",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ad6fc6d7_93e0bdbb",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2021-01-22T01:42:01Z",
      "side": 1,
      "message": "I agree with Mark here, and your developer-oriented argument. \"-R\" should do everything needed to make the process seamless. Calling enableGsi(true) would make it one-shot, right?",
      "parentUuid": "868aad87_dd7ff7d6",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cbe4481e_c49eb9d8",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2021-01-22T07:02:06Z",
      "side": 1,
      "message": "Done.\nAnd right this would enable DSU in one-shot mode.",
      "parentUuid": "ad6fc6d7_93e0bdbb",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c1d055db_41fb6d6a",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2021-01-22T13:12:08Z",
      "side": 1,
      "message": "Yes, this command is _fire_\n\nIf you feel like it, you can add a (long) flag, or piggy back an optional argument, to override that, so that they have the option of selecting _which_ they reboot into.\n\neg: -R\u003dgsi (or --reboot\u003d[gsi|dsu]), -R\u003dhost, whereas -R just reboots into whatever is currently running (gsi/dsu or host at the time). Whatever you do, it is all love of the developers (us, all of us!), as long as it is documented in --help you are in good stead.\n\nNot in scope: just a question, we also have control (as in it is not a toybox executable) over the android reboot command, do you have a flag/option there as interface candy?  adb reboot dsu, does it work? should it work? ;-)",
      "parentUuid": "868aad87_dd7ff7d6",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "38a0dad9_83a9bde3",
        "filename": "fs_mgr/fs_mgr_remount.cpp",
        "patchSetId": 1
      },
      "lineNbr": 214,
      "author": {
        "id": 1337669
      },
      "writtenOn": "2021-01-22T14:35:02Z",
      "side": 1,
      "message": "Thanks for pointing that out, I\u0027ve updated the --help message.\n\nI think supporting only \"-R reboots into whatever is currently running\" is good enough for the majority of use cases.\nI don\u0027t think \"-R\u003dhost within a DSU\" or \"-R\u003ddsu from host\" makes much sense. Plus I don\u0027t feel confortable adding additional entry points to DSU, as it may confuse the user even more.\n\nI don\u0027t think we support booting into DSU via the \"reboot\" command right now. I don\u0027t know the reason (as I wasn\u0027t in the team while DSU/gsi_tool is developed), probably because nobody ever asked? But I think it is useful if we have \"adb reboot [dsu|gsi]\" to function like \"gsi_tool enable -s \u0026\u0026 reboot\".",
      "parentUuid": "c1d055db_41fb6d6a",
      "range": {
        "startLine": 214,
        "startChar": 39,
        "endLine": 214,
        "endChar": 67
      },
      "revId": "3b6b70ab1985cb364dddd4357de385724f1481cb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}