{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "cebced78_10208c16",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2023-10-25T22:15:16Z",
      "side": 1,
      "message": "+elsk/zhangkelvin for fastboot...\n\n(idea sgtm though; this is what we\u0027ve done in adb for integration testing, and -- while obviously we\u0027d prefer more unit testing -- it\u0027s helped us cover a lot of things that just weren\u0027t practical to retrofit unit tests to without a massive rewrite we can\u0027t afford.)",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41d9e396_63db4580",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2023-10-26T00:58:22Z",
      "side": 1,
      "message": "When this test gets scheduled by tradefed, are we sure that we are running current build\u0027s fastboot binary, and not some pre-installed ones on tradefed host?",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75d5e71f_af151626",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1156333
      },
      "writtenOn": "2023-10-26T19:26:03Z",
      "side": 1,
      "message": "Yeah. After running \u0027lunch ...\u0027, the fastboot and adb binaries point to the ones built in your local repo. test_adb.py in ADB\u0027s directory is doing the same thing.",
      "parentUuid": "41d9e396_63db4580",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1500772b_33d8306f",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2023-10-26T19:27:45Z",
      "side": 1,
      "message": "When running this locally, it\u0027s surely using your locally built fastboot binary. However, when scheduled on treehugger, I believe it might not have a full android repo. Tests would be downloaded from test_x86_64 target and the unzipped. Worth double checking with tradefed people.",
      "parentUuid": "75d5e71f_af151626",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8ab5ed0d_8c427e12",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1156333
      },
      "writtenOn": "2023-10-26T19:30:47Z",
      "side": 1,
      "message": "We don\u0027t have devices running in fastboot in treehugger anyway, right? This should probably be manual only. I don\u0027t work in the Android tree very often. Is there a way I can configure it to be only manual?",
      "parentUuid": "1500772b_33d8306f",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0eb0a80c_104b9194",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2023-10-26T19:33:02Z",
      "side": 1,
      "message": "remove \n\n```\n    test_config: \"fastboot_integration_test.xml\",\n    test_suites: [\"general-tests\"],\n```",
      "parentUuid": "8ab5ed0d_8c427e12",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ec3ab82_88856631",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2023-10-26T19:34:27Z",
      "side": 1,
      "message": "as long as it\u0027s not in TEST_MAPPING, he doesn\u0027t even need to do that, right?\n\n+jdesprez for whether there\u0027s clever way to make sure you\u0027re running the desired binary (maybe with a `data:`?).",
      "parentUuid": "0eb0a80c_104b9194",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8f276ecb_04e9da05",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1121894
      },
      "writtenOn": "2023-10-26T20:12:50Z",
      "side": 1,
      "message": "if you don\u0027t run in test mapping, you can simply remove test_suites tag to be used locally.\n\nIf you wanted TEST_MAPPING, you probably would have to attempt to use the fastboot that isn\u0027t on PATH, otherwise it wouldn\u0027t use the current one but the lab released one (which defeat purpose of the test). If it\u0027s your data:[] then yes it would work, because we insert the module artifacts ahead in PATH.\n\nTo ensure that at least one device is in fastboot/d you probably want the test to set your device under test in that state by rebooting it, (and then out of that state). Expecting device state to be already fastboot is error prone.",
      "parentUuid": "9ec3ab82_88856631",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2b291e73_3a458a16",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1156333
      },
      "writtenOn": "2023-10-26T20:47:55Z",
      "side": 1,
      "message": "Sorry, this is all pretty new to me. What should I do here? Since this test should be manual, I think it\u0027s reasonable to expect there\u0027s a device already in fastboot or the bootloader. The test fails if there isn\u0027t a device already there.\n\nWhat\u0027s the \"data:\" thing? Part of the build rule?",
      "parentUuid": "8f276ecb_04e9da05",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "29aaffc2_26a92a99",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2023-10-26T21:42:43Z",
      "side": 1,
      "message": "go/androidbp has it all (link is internal only)",
      "parentUuid": "2b291e73_3a458a16",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "36939991_f44e9118",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1156333
      },
      "writtenOn": "2023-10-26T22:28:21Z",
      "side": 1,
      "message": "What about the first part of the question? Are you saying it\u0027s fine if this is a manual test and assumes that a device is already in fastboot?",
      "parentUuid": "29aaffc2_26a92a99",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9daf5a65_c5ab086e",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1121838
      },
      "writtenOn": "2023-10-26T22:34:29Z",
      "side": 1,
      "message": "I think it is fine, but I\u0027ll let Kelvin to confirm.\n\nRegardless of whether there\u0027s an actual device being connected, your test will pass, right?\n\nThe `data:` thing ensures that you are running your test against the fastboot built from the tree, not the fastboot on the host machine (regardless of whether it is there). After setting `data:`, I think you also need to use tricks to find the built binary; it is somewhere relative to the current directory of the test.",
      "parentUuid": "36939991_f44e9118",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c6a93d0_bce8de0c",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1710792
      },
      "writtenOn": "2023-10-26T22:40:27Z",
      "side": 1,
      "message": "It\u0027s fine to leave this test as a local test. In that case, remove the \n\n\n```\ntest_suites: [\"general-tests\"],\n```\n\npart and add \n\n```\ndata: [\"fastboot\"],\n```",
      "parentUuid": "9daf5a65_c5ab086e",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be1d7e1c_f3fbfac3",
        "filename": "fastboot/test_fastboot.py",
        "patchSetId": 3
      },
      "lineNbr": 35,
      "author": {
        "id": 1156333
      },
      "writtenOn": "2023-10-26T22:44:22Z",
      "side": 1,
      "message": "As it stands, the test fails if there\u0027s no device connected, because we can\u0027t verify that `fastboot devices` works without any devices. After all, it\u0027s manual, so I think that\u0027s fine. If it were running on submit, that\u0027d be different.\n\nThank you, Kelvin!",
      "parentUuid": "9daf5a65_c5ab086e",
      "revId": "33db89178e4e2d083a680085a9051ba898b81c4d",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}