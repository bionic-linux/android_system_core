{
  "comments": [
    {
      "key": {
        "uuid": "ac6c4e3e_5f09b101",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "#include \"fs_mgr_dm_linear.h\"\n\n#include \u003clinux/dm-ioctl.h\u003e\n#include \u003cstring.h\u003e\n#include \u003csys/ioctl.h\u003e\n#include \u003csys/stat.h\u003e\n#include \u003cunistd.h\u003e\n\n#include \u003csstream\u003e\n\n#include \u003candroid-base/logging.h\u003e\n#include \u003candroid-base/strings.h\u003e\n\n#include \"fs_mgr_priv.h\"\n#include \"fs_mgr_priv_dm_ioctl.h\"\n\nIs the right format.  As a rule you don\u0027t need to include headers that your associated header (fs_mgr_dm_linear.h) contain, so you can drop vector.",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "075068f4_dfd4749a",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "Probably better to not use stringstream.  We have android::base::StringPrintf, which is the more common option.",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6eb5a0c7_0c3e2b75",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "075068f4_dfd4749a",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a5da68d_52137394",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-04T11:25:18Z",
      "side": 1,
      "message": "Looks like those are data members.\nLet\u0027s add a trailing underscore for them.\n\nhttps://google.github.io/styleguide/cppguide.html#Variable_Names\nData members of classes, both static and non-static, are named like ordinary nonmember variables, but with a trailing underscore.",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 55
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4d99d262_f9f61cf0",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-04T19:12:37Z",
      "side": 1,
      "message": "They\u0027re data members of a struct, the style guide says not to use underscores in that case. Or did you want it to be converted to a class instead?",
      "parentUuid": "3a5da68d_52137394",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 55
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e4dd86ef_2200d5dc",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "You almost definitely don\u0027t want stringstream for a simple concatenation.  You should be able to simply \n\nreturn std::string{static_cast\u003cchar*\u003e(\u0026spec), sizeof(spec)} + argv;",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "03517860_a1a10845",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 73,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e4dd86ef_2200d5dc",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ecc996e3_e1bd8093",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 79,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "Looks great to me now like this!",
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6c34a5c7_46847fa6",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 131,
      "author": {
        "id": 1108565
      },
      "writtenOn": "2018-05-05T00:25:45Z",
      "side": 1,
      "message": "the problem with creating it like this is also that it won\u0027t have selinux labels appplied etc. ueventd takes care of all that for you automagically.\n(sorry, I didn\u0027t reply to your original respond when I pointed out we shouldn\u0027t do this here).\n\ntomcherry@, any better way to have a /dev/block/dm-\u003cname\u003e node create? or is this ok?",
      "range": {
        "startLine": 130,
        "startChar": 1,
        "endLine": 131,
        "endChar": 73
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b25529a6_936190d0",
        "filename": "fs_mgr/fs_mgr_dm_linear.cpp",
        "patchSetId": 2
      },
      "lineNbr": 131,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:15:48Z",
      "side": 1,
      "message": "So it turns out this doesn\u0027t play well with fs_mgr, neither does updating blk_device in the fstab rec. A bunch of code expects basename(blk_device) to be a partition name and it\u0027s kind of gross to add \"dm-\" pattern matching to it.\n\nIt might be worth adding an explicit \"partition_name\" field to fstab recs so we can use the numbered device?",
      "parentUuid": "6c34a5c7_46847fa6",
      "range": {
        "startLine": 130,
        "startChar": 1,
        "endLine": 131,
        "endChar": 73
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a92fb412_6088dac4",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-04T11:25:18Z",
      "side": 1,
      "message": "Since this parameter is consumed by init (userland), instead of kernel, how about move this to device-tree? And use is_android_dt_value_expected(\"lrap\", \"1\");\n\ncontext: b/78615592, kernel cmdline might be getting full\nThe rule is that /proc/cmdline is for bootloader --\u003e kernel, while device-tree is for bootloader --\u003e init/userland.\n\nAlso, init can import device-tree to ro.boot.* properties.\nhttps://android-review.googlesource.com/c/platform/system/core/+/143005\n\nNot sure if there are more \u0027lrap\u0027-related params will be added in the future.\nIf so, maybe use \"ro.boot.lrap.enable\"\u003d\"1\", so you can add ro.boot.lrap.other_name later.",
      "range": {
        "startLine": 126,
        "startChar": 24,
        "endLine": 126,
        "endChar": 40
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dc974944_35a08a62",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-04T18:21:36Z",
      "side": 1,
      "message": "Originally it was in device-tree, but @sspatil requested it to be a kernel cmdline flag since it\u0027s a temporary thing for testing. I don\u0027t particularly mind either way.",
      "parentUuid": "a92fb412_6088dac4",
      "range": {
        "startLine": 126,
        "startChar": 24,
        "endLine": 126,
        "endChar": 40
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "226b11a1_1035b067",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 126,
      "author": {
        "id": 1108565
      },
      "writtenOn": "2018-05-05T00:25:45Z",
      "side": 1,
      "message": "yeah, we actually don\u0027t want this to be cmdline parameter eventually. That said, eventually these androidboot.XYZ things are there to stay and just that we may\nrequire them to come out of DT instead of cmdline.\n\nThe cmdline usage for this particular one is convenient since we can easily change it and do \u0027make bootimage\u0027 and to add / remove the flag.",
      "parentUuid": "dc974944_35a08a62",
      "range": {
        "startLine": 126,
        "startChar": 24,
        "endLine": 126,
        "endChar": 40
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0339a147_2958024f",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 186,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "You can just use auto here.  You\u0027ll then have the space to use \u0027partition\u0027 in place of pt.  Full names are preferred except for very common things abbreviations (num, fd, etc).",
      "range": {
        "startLine": 186,
        "startChar": 15,
        "endLine": 186,
        "endChar": 41
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc246487_260b991f",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 186,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-04T11:25:18Z",
      "side": 1,
      "message": "+1 for s/pt/partition",
      "parentUuid": "0339a147_2958024f",
      "range": {
        "startLine": 186,
        "startChar": 15,
        "endLine": 186,
        "endChar": 41
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7597e76b_4af8f1d0",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 186,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bc246487_260b991f",
      "range": {
        "startLine": 186,
        "startChar": 15,
        "endLine": 186,
        "endChar": 41
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8f6f7c83_908ed5df",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 189,
      "author": {
        "id": 1064128
      },
      "writtenOn": "2018-05-04T02:56:23Z",
      "side": 1,
      "message": "There is android::base::Basename() that wraps basename() for C++.",
      "range": {
        "startLine": 189,
        "startChar": 54,
        "endLine": 189,
        "endChar": 62
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc2758c2_7379ca59",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 189,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8f6f7c83_908ed5df",
      "range": {
        "startLine": 189,
        "startChar": 54,
        "endLine": 189,
        "endChar": 62
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "eca0f1ca_54adbc6a",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 250,
      "author": {
        "id": 1108565
      },
      "writtenOn": "2018-05-05T00:25:45Z",
      "side": 1,
      "message": "this can very easily just be the fs-mgr API, so you hide the details of where you read the partition / mapping metadata from Init code completely.",
      "range": {
        "startLine": 250,
        "startChar": 22,
        "endLine": 250,
        "endChar": 45
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c16727c_12b2ee0e",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 250,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eca0f1ca_54adbc6a",
      "range": {
        "startLine": 250,
        "startChar": 22,
        "endLine": 250,
        "endChar": 45
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5197dba7_ad5d0dae",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 257,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2018-05-04T11:25:18Z",
      "side": 1,
      "message": "nit: failed to open ... seems more common",
      "range": {
        "startLine": 257,
        "startChar": 49,
        "endLine": 257,
        "endChar": 63
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d164379_81356713",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 257,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5197dba7_ad5d0dae",
      "range": {
        "startLine": 257,
        "startChar": 49,
        "endLine": 257,
        "endChar": 63
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34af7104_9e1f0256",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 259,
      "author": {
        "id": 1108565
      },
      "writtenOn": "2018-05-05T00:25:45Z",
      "side": 1,
      "message": "I think this whole block can be moved to fs_mgr and into CreateDmDeviceForPartition(). We aren\u0027t doing anything with it here.\nAlso, is consistent with how dm-verity devices get created.",
      "range": {
        "startLine": 255,
        "startChar": 1,
        "endLine": 259,
        "endChar": 5
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "70e48369_555c0d27",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 259,
      "author": {
        "id": 1290458
      },
      "writtenOn": "2018-05-05T01:14:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "34af7104_9e1f0256",
      "range": {
        "startLine": 255,
        "startChar": 1,
        "endLine": 259,
        "endChar": 5
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a4794e5f_8e394896",
        "filename": "init/init_first_stage.cpp",
        "patchSetId": 2
      },
      "lineNbr": 260,
      "author": {
        "id": 1108565
      },
      "writtenOn": "2018-05-05T00:25:45Z",
      "side": 1,
      "message": "auto?",
      "range": {
        "startLine": 260,
        "startChar": 15,
        "endLine": 260,
        "endChar": 42
      },
      "revId": "0e3376a17c7e8f9163e247dccb1352fd9a0af945",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}