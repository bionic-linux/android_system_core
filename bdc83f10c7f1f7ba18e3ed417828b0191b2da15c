{
  "comments": [
    {
      "key": {
        "uuid": "d69a05c0_8f32edb7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-10-01T13:36:57Z",
      "side": 1,
      "message": "Note that I\u0027m not fixing this for the other APEX ld.config.txt\u0027s, because they don\u0027t support the %SANITIZER_RUNTIME_LIBRARIES% expansion. Hence this fix isn\u0027t strictly speaking complete, and we might run into linker errors for APEX binaries on sanitizer builds.\n\nI think applying this as a rule of thumb makes sense though, and I hope with linkerconfig we\u0027ll solve it easily and consistently. I think it ideally should make it more effort to configure a namespace _without_ the full set of Bionic and sanitizer library links.\n\n+kiyoungkim for thoughts on that. I\u0027ve not tried to update linkerconfig correspondingly, since I don\u0027t know what approach you\u0027d prefer.",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 47
      },
      "revId": "bdc83f10c7f1f7ba18e3ed417828b0191b2da15c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17a6d013_8e2af8f8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1005967
      },
      "writtenOn": "2019-10-01T19:50:18Z",
      "side": 1,
      "message": "Just to make sure we are on the same page: right now apex authors need to either\na. Add a link to platform namespace with the full list of bionic + sanitizer libraries\nor\nb. Add a link with allow_all_shared_libs\n\nThis is not perfect, but adding an apex already requires synchronizing with the global ld.config.txt if the libraries within the apex need to be externally accessible, where the author can pick up the magic library list. Also, we have a presubmit with hwasan, so at least the mistakes in boot-critical apexes will be detected.\n\nAt a glance, all existing apexes do either (a) or (b).",
      "parentUuid": "d69a05c0_8f32edb7",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 47
      },
      "revId": "bdc83f10c7f1f7ba18e3ed417828b0191b2da15c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c3d0d6a9_aff1ce98",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-10-01T20:15:57Z",
      "side": 1,
      "message": "Correct, (b) is a superset of (a), but I think (a) is preferable to avoid unintentional overrides (the exception in the runtime namespace is there for a reason).\n\nIndeed the need for config synchronisation is a problem, and I believe it\u0027s one that linkerconfig will tackle down the line.\n\nSpeaking of linkerconfig, I noticed in a different CL that it appears to be the source of truth now, at least when I build and boot locally. kiyoungkim, can you please confirm that? Are these files still in use anywhere?\n\nThat being the case, this CL isn\u0027t very useful as-is; I\u0027ll update it with the necessary linkerconfig changes.",
      "parentUuid": "17a6d013_8e2af8f8",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 47
      },
      "revId": "bdc83f10c7f1f7ba18e3ed417828b0191b2da15c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ef8d6681_89860c8c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-10-03T13:20:30Z",
      "side": 1,
      "message": "Missed mailing this out yesterday, but I got a linkerconfig change in https://r.android.com/1132617 to show what I mean in the first comment. It doesn\u0027t go quite as far as DTRT by default, but it puts the link creation into shared code.\n\nLeft here is the change in ld.config.vndk_lite.txt, which I gather still isn\u0027t managed by linkerconfig.",
      "parentUuid": "c3d0d6a9_aff1ce98",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 47
      },
      "revId": "bdc83f10c7f1f7ba18e3ed417828b0191b2da15c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f052dbe_913da3b9",
        "filename": "rootdir/etc/ld.config.vndk_lite.txt",
        "patchSetId": 2
      },
      "lineNbr": 517,
      "author": {
        "id": 1373864
      },
      "writtenOn": "2019-10-01T13:36:57Z",
      "side": 1,
      "message": "Just happened to notice this line was gone. I think it was removed by mistake in https://r.android.com/1014637.\n\n(The fact that we\u0027ve never noticed just goes to show how all the duplication in these files leads to testing gaps, and I\u0027d be surprised if these lesser used sections are actually correct. :\\ Can\u0027t wait to switch to linkerconfig.)",
      "revId": "bdc83f10c7f1f7ba18e3ed417828b0191b2da15c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}