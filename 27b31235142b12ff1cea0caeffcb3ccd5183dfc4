{
  "comments": [
    {
      "key": {
        "uuid": "ce9ecc7c_fc2ea602",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1056364
      },
      "writtenOn": "2017-05-18T18:15:27Z",
      "side": 1,
      "message": "what about A_AUTH? Isn\u0027t L82 already cover this? or you met something special?",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "11af95e9_cbdee1c6",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2017-05-18T22:07:50Z",
      "side": 1,
      "message": "I think the handling on line 82 doesn\u0027t work in all cases (this doesn\u0027t either, but I think it works in more).\nSpecifically, if the packet that\u0027s in the queue is a payload and not a message, the read at line 70 will fail and return -1.\n\nI think this covers all of the cases that the code above does, do you think I should just delete the handling there?",
      "parentUuid": "ce9ecc7c_fc2ea602",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b9e87a67_5e5732bd",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1056364
      },
      "writtenOn": "2017-05-18T23:45:09Z",
      "side": 1,
      "message": "I see. The logic of UsbReadMessage has been changed. Instead of adding more code, why not change it back to UsbReadMessage in https://android-review.googlesource.com/#/c/342653/12/adb/transport_usb.cpp?\n\nAnd L110 will not work if using initial_read.",
      "parentUuid": "11af95e9_cbdee1c6",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6862b06a_cd8c656d",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2017-05-23T20:28:04Z",
      "side": 1,
      "message": "I\u0027m not a big fan of the current code because it makes it so that we\u0027re willing to just skip random amounts of data that\u0027s coming across the wire at any point in the connection, when the real problem only occurs at the beginning of connections.",
      "parentUuid": "b9e87a67_5e5732bd",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "44653cd0_298b3af2",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1056364
      },
      "writtenOn": "2017-05-23T22:00:48Z",
      "side": 1,
      "message": "Yes, I agree the problem only occurs at the beginning of connections. But I think at least L106-L112 should be moved to initial_read, otherwise the device offlince problem can occur for the reason in L107-L108. This can be tested by test_device.DeviceOfflineTest, however, you need to write a script to run the tests in a loop for a long time (like several hours). Because the situation in problem is hard to reproduce.",
      "parentUuid": "6862b06a_cd8c656d",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "15ec2e8a_74ee02f7",
        "filename": "adb/transport_usb.cpp",
        "patchSetId": 1
      },
      "lineNbr": 137,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2017-05-24T07:46:34Z",
      "side": 1,
      "message": "Could you explain the scenario this addresses? Is it for when the host has outgoing packets queued up?",
      "parentUuid": "44653cd0_298b3af2",
      "range": {
        "startLine": 137,
        "startChar": 30,
        "endLine": 137,
        "endChar": 36
      },
      "revId": "27b31235142b12ff1cea0caeffcb3ccd5183dfc4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}