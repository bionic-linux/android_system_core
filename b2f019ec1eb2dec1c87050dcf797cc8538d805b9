{
  "comments": [
    {
      "key": {
        "uuid": "51625590_cb2889a9",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2016-09-01T19:31:06Z",
      "side": 1,
      "message": "If fd is no longer required, it should be closed here right after mmap(), circumventing any closes below, but worry about file closes above.\n\nclose(fd);\nfd \u003d -1;\n\nShould do the trick.",
      "range": {
        "startLine": 91,
        "startChar": 38,
        "endLine": 91,
        "endChar": 39
      },
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d113a50f_f4ad983d",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2016-09-01T20:30:36Z",
      "side": 1,
      "message": "yeah, lets us remove the close from \"fail:\" too. we should have the One True close occur after the \"if\" below, though, so we don\u0027t clobber errno...\n\n...except that has a goto fail.\n\n/me wishes this file was C++ so we could just use unique_fd...",
      "parentUuid": "51625590_cb2889a9",
      "range": {
        "startLine": 91,
        "startChar": 38,
        "endLine": 91,
        "endChar": 39
      },
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d113a50f_9446e473",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2016-09-01T20:44:07Z",
      "side": 1,
      "message": "a little more complicated because on line 87 it wants us to call close in fail.\n\nerrno gets clobbered all over the place here, if we wanted to be accurate we should hold on to a save_errno after important calls calls (open, lseek, mmap \u0026 processFile()), and restore in fail path.\n\nBeyond the scope of this fix, will look into correcting that in a followup orphan\u0027d patch to AOSP for Android next.",
      "parentUuid": "d113a50f_f4ad983d",
      "range": {
        "startLine": 91,
        "startChar": 38,
        "endLine": 91,
        "endChar": 39
      },
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "16fd3327_5ec9554b",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1014443
      },
      "writtenOn": "2016-09-02T10:54:47Z",
      "side": 1,
      "message": "I\u0027d suggest moving this file over to C++ - there\u0027s a lot that can be cleaned up. \n\n(That includes the error message that says \"ARRRRGH\".)",
      "parentUuid": "d113a50f_9446e473",
      "range": {
        "startLine": 91,
        "startChar": 38,
        "endLine": 91,
        "endChar": 39
      },
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d113a50f_94b8a481",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 95,
      "author": {
        "id": 1003224
      },
      "writtenOn": "2016-09-01T20:30:36Z",
      "side": 1,
      "message": "isn\u0027t there a bug here? MAP_FAILED !\u003d NULL, so we\u0027ll try to munmap on L122. i guess it doesn\u0027t matter because no-one checks the result of the munmap.",
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d113a50f_d4697cf1",
        "filename": "liblog/event_tag_map.c",
        "patchSetId": 1
      },
      "lineNbr": 95,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2016-09-01T20:44:07Z",
      "side": 1,
      "message": "Cleanliness suggests do not call munmap if mapAddr \u003d\u003d MAP_FAILED ... but it is not harmful.\n\nAs for NULL, it is supposed to be a can-not-happen, but I have checked for both as \u0027failures\u0027 in other arenas so should be done.\n\nAlso outside the scope of this CL, so will followup later.",
      "parentUuid": "d113a50f_94b8a481",
      "revId": "b2f019ec1eb2dec1c87050dcf797cc8538d805b9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}