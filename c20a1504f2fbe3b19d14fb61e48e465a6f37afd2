{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9f5ec599_36fd7d8d",
        "filename": "libprocessgroup/Android.bp",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2024-03-28T18:37:17Z",
      "side": 1,
      "message": "nit: you can simply have `-DFORCE_MEMCG_V2`",
      "range": {
        "startLine": 23,
        "startChar": 17,
        "endLine": 23,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a47fe9e9_5016bf7e",
        "filename": "libprocessgroup/Android.bp",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1930620
      },
      "writtenOn": "2024-03-28T20:03:36Z",
      "side": 1,
      "message": "I don\u0027t see how that is better. Then I need more code/conditions in build_flags.h.",
      "parentUuid": "9f5ec599_36fd7d8d",
      "range": {
        "startLine": 23,
        "startChar": 17,
        "endLine": 23,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c9f4169_13492d5e",
        "filename": "libprocessgroup/build_flags.h",
        "patchSetId": 9
      },
      "lineNbr": 26,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2024-03-28T18:37:17Z",
      "side": 1,
      "message": "and in here:\n```\n#ifdef FORCE_MEMCG_V2\n    return true;\n#else\n    return false;\n#endif\n```",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 26,
        "endChar": 34
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a0bf4348_6dd2d595",
        "filename": "libprocessgroup/setup/cgroup_map_write.cpp",
        "patchSetId": 9
      },
      "lineNbr": 207,
      "author": {
        "id": 1157738
      },
      "writtenOn": "2024-03-28T18:37:17Z",
      "side": 1,
      "message": "This is fragile. This can be something like: `cgroup_disable\u003dcpu,pressure,memory`. Would checking `/sys/fs/cgroup/cgroup.controllers` work instead?",
      "range": {
        "startLine": 207,
        "startChar": 25,
        "endLine": 207,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "664da83a_020283f9",
        "filename": "libprocessgroup/setup/cgroup_map_write.cpp",
        "patchSetId": 9
      },
      "lineNbr": 207,
      "author": {
        "id": 1930620
      },
      "writtenOn": "2024-03-28T20:03:36Z",
      "side": 1,
      "message": "Good point. I don\u0027t think `/sys/fs/cgroup/cgroup.controllers` will work, because if memcg is mounted as v1 I don\u0027t think it would show up there. Let me check.",
      "parentUuid": "a0bf4348_6dd2d595",
      "range": {
        "startLine": 207,
        "startChar": 25,
        "endLine": 207,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f7bd33e7_755a5179",
        "filename": "libprocessgroup/setup/cgroup_map_write.cpp",
        "patchSetId": 9
      },
      "lineNbr": 207,
      "author": {
        "id": 1930620
      },
      "writtenOn": "2024-03-28T21:31:54Z",
      "side": 1,
      "message": "Confirmed we can\u0027t just check `/sys/fs/cgroup/cgroup.controllers`. I guess I\u0027ll have to modify this to loop through the whole cmdline and check each cgroup_disable.",
      "parentUuid": "664da83a_020283f9",
      "range": {
        "startLine": 207,
        "startChar": 25,
        "endLine": 207,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c2c66d5_01aec129",
        "filename": "libprocessgroup/setup/cgroup_map_write.cpp",
        "patchSetId": 9
      },
      "lineNbr": 207,
      "author": {
        "id": 1930620
      },
      "writtenOn": "2024-03-28T21:45:58Z",
      "side": 1,
      "message": "Actually, memcg can\u0027t be on v1 when this function is called. It\u0027s only when being forced to v2 that this gets called. But it looks possible that `/sys/fs/cgroup` may not be mounted before here, since `MountV2CgroupController` gets called afterwards. So I guess I could move this check into `MountV2CgroupController` and look at `/sys/fs/cgroup/cgroup.controllers` instead of `/proc/cmdline`.",
      "parentUuid": "f7bd33e7_755a5179",
      "range": {
        "startLine": 207,
        "startChar": 25,
        "endLine": 207,
        "endChar": 46
      },
      "revId": "c20a1504f2fbe3b19d14fb61e48e465a6f37afd2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}