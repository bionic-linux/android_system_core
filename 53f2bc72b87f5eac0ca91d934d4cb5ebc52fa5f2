{
  "comments": [
    {
      "key": {
        "uuid": "30592d74_2fae190a",
        "filename": "logd/LogBuffer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 676,
      "author": {
        "id": 1069543
      },
      "writtenOn": "2015-10-07T21:02:31Z",
      "side": 1,
      "message": "Did you intend to do a \"break\" within the \"retry \u003d\u003d 1\" block? If not, then this is really the 2nd-to-last pass since we will go back to the top of the loop and execute lines 665-667 again. Seems odd.\n\nWould it be better to change 668+ to:\n\n  if (!busy)\n      break;\n  if (!--retry) {\n    // last pass\n    \u003call the last pass stuff\u003e\n    break;\n  }",
      "range": {
        "startLine": 673,
        "startChar": 12,
        "endLine": 676,
        "endChar": 9
      },
      "revId": "53f2bc72b87f5eac0ca91d934d4cb5ebc52fa5f2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "504861a0_15d364e4",
        "filename": "logd/LogBuffer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 676,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2015-10-07T22:50:32Z",
      "side": 1,
      "message": "The busy \u003d prune(id, 1, uid)\n\nDoes not clear, it merely removes one entry if it needs to. I figured the 1 is very clearly not a ULONG_MAX. Its real purpose it to check if it is still busy after the sleep, if it is still busy, then we want to tell all the readers to \u0027go away\u0027, we kill them, then do yet another run to clear all the entries ULONG_MAX. If it is not busy, then we preserve the readers and let one more run go unhindered.\n\nThe one-line comment on line 663 describes what we are doing, it is obviously not enough comment ;-{",
      "parentUuid": "30592d74_2fae190a",
      "range": {
        "startLine": 673,
        "startChar": 12,
        "endLine": 676,
        "endChar": 9
      },
      "revId": "53f2bc72b87f5eac0ca91d934d4cb5ebc52fa5f2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "504861a0_3504a0e5",
        "filename": "logd/LogBuffer.cpp",
        "patchSetId": 1
      },
      "lineNbr": 676,
      "author": {
        "id": 1069543
      },
      "writtenOn": "2015-10-07T23:13:31Z",
      "side": 1,
      "message": "What isn\u0027t clear is why you are doing all the \"kill reader\" stuff in the 2nd-to-last pass (and the \"last pass\" comment is misleading since this is the end of the previous.\n\nJust to make it clearer, how about moving this stuff to the top of the loop (before the busy\u003dprune()), so it really is part of the last pass instead of the end of the previous pass.",
      "parentUuid": "504861a0_15d364e4",
      "range": {
        "startLine": 673,
        "startChar": 12,
        "endLine": 676,
        "endChar": 9
      },
      "revId": "53f2bc72b87f5eac0ca91d934d4cb5ebc52fa5f2",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}